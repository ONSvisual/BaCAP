import{S as We,i as Ue,s as Ke,k as V,l as N,m as M,h as g,n as b,b as D,B as me,Q as fe,Z as x,g as ve,t as z,d as pe,f as B,a0 as xe,a5 as Lt,o as ft,a6 as Ol,U as Se,e as ye,T as Bt,v as Te,w as ne,x as be,y as se,z as ae,q as ce,r as de,G as L,u as It,A as Vt,a as Z,c as Y,K as rt,L as ot,p as Oe,a7 as Ut,M as Ql,N as Xl,a8 as xl,C as $l,D as ei,E as ti,F as li,a9 as ii,aa as Jt,ab as xt,Y as ut,ac as Zt,ad as Tl,$ as ni,W as Qe,X as it,a1 as si,a2 as ai,ae as Gt,af as ri,H as ze,ag as Ae,I as oi,J as ui,_ as ht,V as fi,a4 as lt}from"../../../../chunks/index-bbb59b27.js";import{m as Kt,e as Nt,f as At,h as Ft,i as ci,j as Vl,k as Nl,l as di,n as hi,o as mi,I as Xe,t as mt,p as Ze,q as Pe,g as _i,r as $t,a as gi,d as bi,c as vi,u as Rt,v as Wt,w as pi,s as yi,x as wi}from"../../../../chunks/git-2ab0309a.js";import{b as Si}from"../../../../chunks/paths-6cd3a76e.js";import{m as ki}from"../../../../chunks/maplibre-gl-8f0e942f.js";function Ii(l,e){const t=l.getBoundingClientRect(),i=e.getBoundingClientRect(),n={};return n.top=t.top<0,n.left=t.left<0,n.bottom=t.bottom+i.height>(window.innerHeight||document.documentElement.clientHeight),n.right=t.right>(window.innerWidth||document.documentElement.clientWidth),n.any=n.top||n.left||n.bottom||n.right,n}function Li(l){let e,t=l[0](l[1],l[2])+"",i;return{c(){e=V("div"),this.h()},l(n){e=N(n,"DIV",{class:!0});var a=M(e);a.forEach(g),this.h()},h(){b(e,"class",i="item "+l[3]+" svelte-3e0qet")},m(n,a){D(n,e,a),e.innerHTML=t},p(n,[a]){a&7&&t!==(t=n[0](n[1],n[2])+"")&&(e.innerHTML=t),a&8&&i!==(i="item "+n[3]+" svelte-3e0qet")&&b(e,"class",i)},i:me,o:me,d(n){n&&g(e)}}}function Ei(l,e,t){let{isActive:i=!1}=e,{isFirst:n=!1}=e,{isHover:a=!1}=e,{isSelectable:s=!1}=e,{getOptionLabel:o=void 0}=e,{item:r=void 0}=e,{filterText:u=""}=e,m="";return l.$$set=c=>{"isActive"in c&&t(4,i=c.isActive),"isFirst"in c&&t(5,n=c.isFirst),"isHover"in c&&t(6,a=c.isHover),"isSelectable"in c&&t(7,s=c.isSelectable),"getOptionLabel"in c&&t(0,o=c.getOptionLabel),"item"in c&&t(1,r=c.item),"filterText"in c&&t(2,u=c.filterText)},l.$$.update=()=>{if(l.$$.dirty&242){const c=[];i&&c.push("active"),n&&c.push("first"),a&&c.push("hover"),r.isGroupHeader&&c.push("groupHeader"),r.isGroupItem&&c.push("groupItem"),s||c.push("notSelectable"),t(3,m=c.join(" "))}},[o,r,u,m,i,n,a,s]}class Al extends We{constructor(e){super(),Ue(this,e,Ei,Li,Ke,{isActive:4,isFirst:5,isHover:6,isSelectable:7,getOptionLabel:0,item:1,filterText:2})}}function el(l,e,t){const i=l.slice();return i[41]=e[t],i[42]=t,i}function Ci(l){let e,t,i=l[1],n=[];for(let o=0;o<i.length;o+=1)n[o]=il(el(l,i,o));const a=o=>z(n[o],1,1,()=>{n[o]=null});let s=null;return i.length||(s=tl(l)),{c(){for(let o=0;o<n.length;o+=1)n[o].c();e=ye(),s&&s.c()},l(o){for(let r=0;r<n.length;r+=1)n[r].l(o);e=ye(),s&&s.l(o)},m(o,r){for(let u=0;u<n.length;u+=1)n[u].m(o,r);D(o,e,r),s&&s.m(o,r),t=!0},p(o,r){if(r[0]&114390){i=o[1];let u;for(u=0;u<i.length;u+=1){const m=el(o,i,u);n[u]?(n[u].p(m,r),B(n[u],1)):(n[u]=il(m),n[u].c(),B(n[u],1),n[u].m(e.parentNode,e))}for(ve(),u=i.length;u<n.length;u+=1)a(u);pe(),!i.length&&s?s.p(o,r):i.length?s&&(s.d(1),s=null):(s=tl(o),s.c(),s.m(e.parentNode,e))}},i(o){if(!t){for(let r=0;r<i.length;r+=1)B(n[r]);t=!0}},o(o){n=n.filter(Boolean);for(let r=0;r<n.length;r+=1)z(n[r]);t=!1},d(o){Bt(n,o),o&&g(e),s&&s.d(o)}}}function Oi(l){let e,t,i;var n=l[3];function a(s){return{props:{items:s[1],itemHeight:s[8],$$slots:{default:[Ni,({item:o,i:r})=>({41:o,42:r}),({item:o,i:r})=>[0,(o?1024:0)|(r?2048:0)]]},$$scope:{ctx:s}}}}return n&&(e=Te(n,a(l))),{c(){e&&ne(e.$$.fragment),t=ye()},l(s){e&&be(e.$$.fragment,s),t=ye()},m(s,o){e&&se(e,s,o),D(s,t,o),i=!0},p(s,o){const r={};if(o[0]&2&&(r.items=s[1]),o[0]&256&&(r.itemHeight=s[8]),o[0]&9814|o[1]&11264&&(r.$$scope={dirty:o,ctx:s}),n!==(n=s[3])){if(e){ve();const u=e;z(u.$$.fragment,1,0,()=>{ae(u,1)}),pe()}n?(e=Te(n,a(s)),ne(e.$$.fragment),B(e.$$.fragment,1),se(e,t.parentNode,t)):e=null}else n&&e.$set(r)},i(s){i||(e&&B(e.$$.fragment,s),i=!0)},o(s){e&&z(e.$$.fragment,s),i=!1},d(s){s&&g(t),e&&ae(e,s)}}}function tl(l){let e,t=!l[11]&&ll(l);return{c(){t&&t.c(),e=ye()},l(i){t&&t.l(i),e=ye()},m(i,n){t&&t.m(i,n),D(i,e,n)},p(i,n){i[11]?t&&(t.d(1),t=null):t?t.p(i,n):(t=ll(i),t.c(),t.m(e.parentNode,e))},d(i){t&&t.d(i),i&&g(e)}}}function ll(l){let e,t;return{c(){e=V("div"),t=ce(l[12]),this.h()},l(i){e=N(i,"DIV",{class:!0});var n=M(e);t=de(n,l[12]),n.forEach(g),this.h()},h(){b(e,"class","empty svelte-1uyqfml")},m(i,n){D(i,e,n),L(e,t)},p(i,n){n[0]&4096&&It(t,i[12])},d(i){i&&g(e)}}}function Ti(l){let e,t,i,n,a,s;var o=l[4];function r(h){return{props:{item:h[41],filterText:h[13],getOptionLabel:h[6],isFirst:qt(h[42]),isActive:Mt(h[41],h[9],h[10]),isHover:Dt(h[2],h[41],h[42],h[1]),isSelectable:_t(h[41])}}}o&&(t=Te(o,r(l)));function u(){return l[29](l[42])}function m(){return l[30](l[42])}function c(...h){return l[31](l[41],l[42],...h)}return{c(){e=V("div"),t&&ne(t.$$.fragment),i=Z(),this.h()},l(h){e=N(h,"DIV",{class:!0,tabindex:!0});var d=M(e);t&&be(t.$$.fragment,d),i=Y(d),d.forEach(g),this.h()},h(){b(e,"class","listItem"),b(e,"tabindex","-1")},m(h,d){D(h,e,d),t&&se(t,e,null),L(e,i),n=!0,a||(s=[x(e,"mouseover",u),x(e,"focus",m),x(e,"click",c)],a=!0)},p(h,d){l=h;const y={};if(d[0]&2&&(y.item=l[41]),d[0]&8192&&(y.filterText=l[13]),d[0]&64&&(y.getOptionLabel=l[6]),d[0]&1538&&(y.isActive=Mt(l[41],l[9],l[10])),d[0]&6&&(y.isHover=Dt(l[2],l[41],l[42],l[1])),d[0]&2&&(y.isSelectable=_t(l[41])),o!==(o=l[4])){if(t){ve();const w=t;z(w.$$.fragment,1,0,()=>{ae(w,1)}),pe()}o?(t=Te(o,r(l)),ne(t.$$.fragment),B(t.$$.fragment,1),se(t,e,i)):t=null}else o&&t.$set(y)},i(h){n||(t&&B(t.$$.fragment,h),n=!0)},o(h){t&&z(t.$$.fragment,h),n=!1},d(h){h&&g(e),t&&ae(t),a=!1,xe(s)}}}function Vi(l){let e,t=l[7](l[41])+"",i;return{c(){e=V("div"),i=ce(t),this.h()},l(n){e=N(n,"DIV",{class:!0});var a=M(e);i=de(a,t),a.forEach(g),this.h()},h(){b(e,"class","listGroupTitle svelte-1uyqfml")},m(n,a){D(n,e,a),L(e,i)},p(n,a){a[0]&130&&t!==(t=n[7](n[41])+"")&&It(i,t)},i:me,o:me,d(n){n&&g(e)}}}function il(l){let e,t,i,n;const a=[Vi,Ti],s=[];function o(r,u){return r[41].isGroupHeader&&!r[41].isSelectable?0:1}return e=o(l),t=s[e]=a[e](l),{c(){t.c(),i=ye()},l(r){t.l(r),i=ye()},m(r,u){s[e].m(r,u),D(r,i,u),n=!0},p(r,u){let m=e;e=o(r),e===m?s[e].p(r,u):(ve(),z(s[m],1,1,()=>{s[m]=null}),pe(),t=s[e],t?t.p(r,u):(t=s[e]=a[e](r),t.c()),B(t,1),t.m(i.parentNode,i))},i(r){n||(B(t),n=!0)},o(r){z(t),n=!1},d(r){s[e].d(r),r&&g(i)}}}function Ni(l){let e,t,i,n,a;var s=l[4];function o(c){return{props:{item:c[41],filterText:c[13],getOptionLabel:c[6],isFirst:qt(c[42]),isActive:Mt(c[41],c[9],c[10]),isHover:Dt(c[2],c[41],c[42],c[1]),isSelectable:_t(c[41])}}}s&&(t=Te(s,o(l)));function r(){return l[26](l[42])}function u(){return l[27](l[42])}function m(...c){return l[28](l[41],l[42],...c)}return{c(){e=V("div"),t&&ne(t.$$.fragment),this.h()},l(c){e=N(c,"DIV",{class:!0});var h=M(e);t&&be(t.$$.fragment,h),h.forEach(g),this.h()},h(){b(e,"class","listItem")},m(c,h){D(c,e,h),t&&se(t,e,null),i=!0,n||(a=[x(e,"mouseover",r),x(e,"focus",u),x(e,"click",m)],n=!0)},p(c,h){l=c;const d={};if(h[1]&1024&&(d.item=l[41]),h[0]&8192&&(d.filterText=l[13]),h[0]&64&&(d.getOptionLabel=l[6]),h[1]&2048&&(d.isFirst=qt(l[42])),h[0]&1536|h[1]&1024&&(d.isActive=Mt(l[41],l[9],l[10])),h[0]&6|h[1]&3072&&(d.isHover=Dt(l[2],l[41],l[42],l[1])),h[1]&1024&&(d.isSelectable=_t(l[41])),s!==(s=l[4])){if(t){ve();const y=t;z(y.$$.fragment,1,0,()=>{ae(y,1)}),pe()}s?(t=Te(s,o(l)),ne(t.$$.fragment),B(t.$$.fragment,1),se(t,e,null)):t=null}else s&&t.$set(d)},i(c){i||(t&&B(t.$$.fragment,c),i=!0)},o(c){t&&z(t.$$.fragment,c),i=!1},d(c){c&&g(e),t&&ae(t),n=!1,xe(a)}}}function Ai(l){let e,t,i,n,a,s;const o=[Oi,Ci],r=[];function u(m,c){return m[5]?0:1}return t=u(l),i=r[t]=o[t](l),{c(){e=V("div"),i.c(),this.h()},l(m){e=N(m,"DIV",{class:!0,style:!0});var c=M(e);i.l(c),c.forEach(g),this.h()},h(){b(e,"class","listContainer svelte-1uyqfml"),b(e,"style",l[14]),fe(e,"virtualList",l[5])},m(m,c){D(m,e,c),r[t].m(e,null),l[32](e),n=!0,a||(s=[x(window,"keydown",l[17]),x(window,"resize",l[18])],a=!0)},p(m,c){let h=t;t=u(m),t===h?r[t].p(m,c):(ve(),z(r[h],1,1,()=>{r[h]=null}),pe(),i=r[t],i?i.p(m,c):(i=r[t]=o[t](m),i.c()),B(i,1),i.m(e,null)),(!n||c[0]&16384)&&b(e,"style",m[14]),(!n||c[0]&32)&&fe(e,"virtualList",m[5])},i(m){n||(B(i),n=!0)},o(m){z(i),n=!1},d(m){m&&g(e),r[t].d(),l[32](null),a=!1,xe(s)}}}function Mt(l,e,t){return e&&e[t]===l[t]}function qt(l){return l===0}function Dt(l,e,t,i){return _t(e)&&(l===t||i.length===1)}function _t(l){return l.isGroupHeader&&l.isSelectable||l.selectable||!l.hasOwnProperty("selectable")}function Fi(l,e,t){const i=Lt();let{container:n=void 0}=e,{VirtualList:a=null}=e,{Item:s=Al}=e,{isVirtualList:o=!1}=e,{items:r=[]}=e,{labelIdentifier:u="label"}=e,{getOptionLabel:m=(I,R)=>{if(I)return I.isCreator?`Create "${R}"`:I[u]}}=e,{getGroupHeaderLabel:c=null}=e,{itemHeight:h=40}=e,{hoverItemIndex:d=0}=e,{value:y=void 0}=e,{optionIdentifier:w="value"}=e,{hideEmptyState:p=!1}=e,{noOptionsMessage:C="No options"}=e,{isMulti:H=!1}=e,{activeItemIndex:S=0}=e,{filterText:_=""}=e,{parent:T=null}=e,{listPlacement:X=null}=e,{listAutoWidth:te=null}=e,{listOffset:j=5}=e,P=0,A=!1,U;ft(()=>{if(r.length>0&&!H&&y){const I=r.findIndex(R=>R[w]===y[w]);I&&t(2,d=I)}ke("active"),n.addEventListener("scroll",()=>{clearTimeout(P),P=setTimeout(()=>{A=!1},100)},!1)}),Ol(()=>{r||t(1,r=[]),r!==U&&r.length>0&&t(2,d=0),U=r});function G(I){I.isCreator||i("itemSelected",I)}function K(I){A||t(2,d=I)}function J(I){const{item:R,i:F,event:he}=I;if(he.stopPropagation(),y&&!H&&y[w]===R[w])return k();R.isCreator?i("itemCreated",_):_t(R)&&(t(19,S=F),t(2,d=F),G(R))}function k(){i("closeList")}async function O(I){if(o)return;let R=!0;for(;R;)I>0&&d===r.length-1?t(2,d=0):I<0&&d===0?t(2,d=r.length-1):t(2,d=d+I),R=!_t(r[d]);await Vt(),ke("hover")}function re(I){switch(I.key){case"Escape":I.preventDefault(),k();break;case"ArrowDown":I.preventDefault(),r.length&&O(1);break;case"ArrowUp":I.preventDefault(),r.length&&O(-1);break;case"Enter":if(I.preventDefault(),r.length===0)break;const R=r[d];if(y&&!H&&y[w]===R[w]){k();break}R.isCreator?i("itemCreated",_):(t(19,S=d),G(r[d]));break;case"Tab":if(I.preventDefault(),r.length===0||y&&y[w]===r[d][w])return k();t(19,S=d),G(r[d]);break}}function ke(I){if(o||!n)return;let R;const F=n.querySelector(`.listItem .${I}`);F&&(R=n.getBoundingClientRect().bottom-F.getBoundingClientRect().bottom),t(0,n.scrollTop-=R,n)}let we;function Ie(){const{height:I,width:R}=T.getBoundingClientRect();t(14,we=""),t(14,we+=`min-width:${R}px;width:${te?"auto":"100%"};`),X==="top"||X==="auto"&&Ii(T,n).bottom?t(14,we+=`bottom:${I+j}px;`):t(14,we+=`top:${I+j}px;`)}const Fe=I=>K(I),_e=I=>K(I),Me=(I,R,F)=>J({item:I,i:R,event:F}),ge=I=>K(I),Ce=I=>K(I),Ee=(I,R,F)=>J({item:I,i:R,event:F});function Ve(I){Se[I?"unshift":"push"](()=>{n=I,t(0,n)})}return l.$$set=I=>{"container"in I&&t(0,n=I.container),"VirtualList"in I&&t(3,a=I.VirtualList),"Item"in I&&t(4,s=I.Item),"isVirtualList"in I&&t(5,o=I.isVirtualList),"items"in I&&t(1,r=I.items),"labelIdentifier"in I&&t(20,u=I.labelIdentifier),"getOptionLabel"in I&&t(6,m=I.getOptionLabel),"getGroupHeaderLabel"in I&&t(7,c=I.getGroupHeaderLabel),"itemHeight"in I&&t(8,h=I.itemHeight),"hoverItemIndex"in I&&t(2,d=I.hoverItemIndex),"value"in I&&t(9,y=I.value),"optionIdentifier"in I&&t(10,w=I.optionIdentifier),"hideEmptyState"in I&&t(11,p=I.hideEmptyState),"noOptionsMessage"in I&&t(12,C=I.noOptionsMessage),"isMulti"in I&&t(21,H=I.isMulti),"activeItemIndex"in I&&t(19,S=I.activeItemIndex),"filterText"in I&&t(13,_=I.filterText),"parent"in I&&t(22,T=I.parent),"listPlacement"in I&&t(23,X=I.listPlacement),"listAutoWidth"in I&&t(24,te=I.listAutoWidth),"listOffset"in I&&t(25,j=I.listOffset)},l.$$.update=()=>{l.$$.dirty[0]&4194305&&T&&n&&Ie()},[n,r,d,a,s,o,m,c,h,y,w,p,C,_,we,K,J,re,Ie,S,u,H,T,X,te,j,Fe,_e,Me,ge,Ce,Ee,Ve]}class Mi extends We{constructor(e){super(),Ue(this,e,Fi,Ai,Ke,{container:0,VirtualList:3,Item:4,isVirtualList:5,items:1,labelIdentifier:20,getOptionLabel:6,getGroupHeaderLabel:7,itemHeight:8,hoverItemIndex:2,value:9,optionIdentifier:10,hideEmptyState:11,noOptionsMessage:12,isMulti:21,activeItemIndex:19,filterText:13,parent:22,listPlacement:23,listAutoWidth:24,listOffset:25},null,[-1,-1])}}function Di(l){let e,t=l[0](l[1])+"";return{c(){e=V("div"),this.h()},l(i){e=N(i,"DIV",{class:!0});var n=M(e);n.forEach(g),this.h()},h(){b(e,"class","selection svelte-pu1q1n")},m(i,n){D(i,e,n),e.innerHTML=t},p(i,[n]){n&3&&t!==(t=i[0](i[1])+"")&&(e.innerHTML=t)},i:me,o:me,d(i){i&&g(e)}}}function Bi(l,e,t){let{getSelectionLabel:i=void 0}=e,{item:n=void 0}=e;return l.$$set=a=>{"getSelectionLabel"in a&&t(0,i=a.getSelectionLabel),"item"in a&&t(1,n=a.item)},[i,n]}class Hi extends We{constructor(e){super(),Ue(this,e,Bi,Di,Ke,{getSelectionLabel:0,item:1})}}function nl(l,e,t){const i=l.slice();return i[9]=e[t],i[11]=t,i}function sl(l){let e,t,i,n,a;function s(...o){return l[6](l[11],...o)}return{c(){e=V("div"),t=rt("svg"),i=rt("path"),this.h()},l(o){e=N(o,"DIV",{class:!0});var r=M(e);t=ot(r,"svg",{width:!0,height:!0,viewBox:!0,focusable:!0,"aria-hidden":!0,role:!0,class:!0});var u=M(t);i=ot(u,"path",{d:!0}),M(i).forEach(g),u.forEach(g),r.forEach(g),this.h()},h(){b(i,"d","M34.923,37.251L24,26.328L13.077,37.251L9.436,33.61l10.923-10.923L9.436,11.765l3.641-3.641L24,19.047L34.923,8.124 l3.641,3.641L27.641,22.688L38.564,33.61L34.923,37.251z"),b(t,"width","100%"),b(t,"height","100%"),b(t,"viewBox","-2 -2 50 50"),b(t,"focusable","false"),b(t,"aria-hidden","true"),b(t,"role","presentation"),b(t,"class","svelte-liu9pa"),b(e,"class","multiSelectItem_clear svelte-liu9pa")},m(o,r){D(o,e,r),L(e,t),L(t,i),n||(a=x(e,"click",s),n=!0)},p(o,r){l=o},d(o){o&&g(e),n=!1,a()}}}function al(l){let e,t,i=l[4](l[9])+"",n,a,s,o,r,u=!l[2]&&!l[3]&&sl(l);function m(...c){return l[7](l[11],...c)}return{c(){e=V("div"),t=V("div"),n=Z(),u&&u.c(),a=Z(),this.h()},l(c){e=N(c,"DIV",{class:!0});var h=M(e);t=N(h,"DIV",{class:!0});var d=M(t);d.forEach(g),n=Y(h),u&&u.l(h),a=Y(h),h.forEach(g),this.h()},h(){b(t,"class","multiSelectItem_label svelte-liu9pa"),b(e,"class",s="multiSelectItem "+(l[1]===l[11]?"active":"")+" "+(l[2]?"disabled":"")+" svelte-liu9pa")},m(c,h){D(c,e,h),L(e,t),t.innerHTML=i,L(e,n),u&&u.m(e,null),L(e,a),o||(r=x(e,"click",m),o=!0)},p(c,h){l=c,h&17&&i!==(i=l[4](l[9])+"")&&(t.innerHTML=i),!l[2]&&!l[3]?u?u.p(l,h):(u=sl(l),u.c(),u.m(e,a)):u&&(u.d(1),u=null),h&6&&s!==(s="multiSelectItem "+(l[1]===l[11]?"active":"")+" "+(l[2]?"disabled":"")+" svelte-liu9pa")&&b(e,"class",s)},d(c){c&&g(e),u&&u.d(),o=!1,r()}}}function Pi(l){let e,t=l[0],i=[];for(let n=0;n<t.length;n+=1)i[n]=al(nl(l,t,n));return{c(){for(let n=0;n<i.length;n+=1)i[n].c();e=ye()},l(n){for(let a=0;a<i.length;a+=1)i[a].l(n);e=ye()},m(n,a){for(let s=0;s<i.length;s+=1)i[s].m(n,a);D(n,e,a)},p(n,[a]){if(a&63){t=n[0];let s;for(s=0;s<t.length;s+=1){const o=nl(n,t,s);i[s]?i[s].p(o,a):(i[s]=al(o),i[s].c(),i[s].m(e.parentNode,e))}for(;s<i.length;s+=1)i[s].d(1);i.length=t.length}},i:me,o:me,d(n){Bt(i,n),n&&g(e)}}}function zi(l,e,t){const i=Lt();let{value:n=[]}=e,{activeValue:a=void 0}=e,{isDisabled:s=!1}=e,{multiFullItemClearable:o=!1}=e,{getSelectionLabel:r=void 0}=e;function u(h,d){d.stopPropagation(),i("multiItemClear",{i:h})}const m=(h,d)=>u(h,d),c=(h,d)=>o?u(h,d):{};return l.$$set=h=>{"value"in h&&t(0,n=h.value),"activeValue"in h&&t(1,a=h.activeValue),"isDisabled"in h&&t(2,s=h.isDisabled),"multiFullItemClearable"in h&&t(3,o=h.multiFullItemClearable),"getSelectionLabel"in h&&t(4,r=h.getSelectionLabel)},[n,a,s,o,r,u,m,c]}class ji extends We{constructor(e){super(),Ue(this,e,zi,Pi,Ke,{value:0,activeValue:1,isDisabled:2,multiFullItemClearable:3,getSelectionLabel:4})}}function rl(l,e,t){const i=l.slice();return i[23]=e[t],i}const Gi=l=>({item:l&32,i:l&32,hoverItemIndex:l&2}),ol=l=>({item:l[23].data,i:l[23].index,hoverItemIndex:l[1]});function Ri(l){let e;return{c(){e=ce("Missing template")},l(t){e=de(t,"Missing template")},m(t,i){D(t,e,i)},d(t){t&&g(e)}}}function ul(l,e){let t,i,n;const a=e[15].default,s=$l(a,e,e[14],ol),o=s||Ri();return{key:l,first:null,c(){t=V("svelte-virtual-list-row"),o&&o.c(),i=Z(),this.h()},l(r){t=N(r,"SVELTE-VIRTUAL-LIST-ROW",{class:!0});var u=M(t);o&&o.l(u),i=Y(u),u.forEach(g),this.h()},h(){Ut(t,"class","svelte-g2cagw"),this.first=t},m(r,u){D(r,t,u),o&&o.m(t,null),L(t,i),n=!0},p(r,u){e=r,s&&s.p&&(!n||u&16418)&&ei(s,a,e,e[14],n?li(a,e[14],u,Gi):ti(e[14]),ol)},i(r){n||(B(o,r),n=!0)},o(r){z(o,r),n=!1},d(r){r&&g(t),o&&o.d(r)}}}function Wi(l){let e,t,i=[],n=new Map,a,s,o,r,u=l[5];const m=c=>c[23].index;for(let c=0;c<u.length;c+=1){let h=rl(l,u,c),d=m(h);n.set(d,i[c]=ul(d,h))}return{c(){e=V("svelte-virtual-list-viewport"),t=V("svelte-virtual-list-contents");for(let c=0;c<i.length;c+=1)i[c].c();this.h()},l(c){e=N(c,"SVELTE-VIRTUAL-LIST-VIEWPORT",{style:!0,class:!0});var h=M(e);t=N(h,"SVELTE-VIRTUAL-LIST-CONTENTS",{style:!0,class:!0});var d=M(t);for(let y=0;y<i.length;y+=1)i[y].l(d);d.forEach(g),h.forEach(g),this.h()},h(){Oe(t,"padding-top",l[6]+"px"),Oe(t,"padding-bottom",l[7]+"px"),Ut(t,"class","svelte-g2cagw"),Oe(e,"height",l[0]),Ut(e,"class","svelte-g2cagw"),Ql(()=>l[18].call(e))},m(c,h){D(c,e,h),L(e,t);for(let d=0;d<i.length;d+=1)i[d].m(t,null);l[16](t),l[17](e),a=Xl(e,l[18].bind(e)),s=!0,o||(r=x(e,"scroll",l[8]),o=!0)},p(c,[h]){h&16418&&(u=c[5],ve(),i=xl(i,h,m,1,c,u,n,t,ii,ul,null,rl),pe()),(!s||h&64)&&Oe(t,"padding-top",c[6]+"px"),(!s||h&128)&&Oe(t,"padding-bottom",c[7]+"px"),(!s||h&1)&&Oe(e,"height",c[0])},i(c){if(!s){for(let h=0;h<u.length;h+=1)B(i[h]);s=!0}},o(c){for(let h=0;h<i.length;h+=1)z(i[h]);s=!1},d(c){c&&g(e);for(let h=0;h<i.length;h+=1)i[h].d();l[16](null),l[17](null),a(),o=!1,r()}}}function Ui(l,e,t){let{$$slots:i={},$$scope:n}=e,{items:a=void 0}=e,{height:s="100%"}=e,{itemHeight:o=40}=e,{hoverItemIndex:r=0}=e,{start:u=0}=e,{end:m=0}=e,c=[],h,d,y,w=0,p,C,H=0,S=0,_;async function T(A,U,G){const{scrollTop:K}=d;await Vt();let J=H-K,k=u;for(;J<U&&k<A.length;){let re=h[k-u];re||(t(10,m=k+1),await Vt(),re=h[k-u]),J+=c[k]=G||re.offsetHeight,k+=1}t(10,m=k);const O=A.length-m;_=(H+J)/m,t(7,S=O*_),c.length=A.length,d&&t(3,d.scrollTop=0,d)}async function X(){const{scrollTop:A}=d,U=u;for(let k=0;k<h.length;k+=1)c[u+k]=o||h[k].offsetHeight;let G=0,K=0;for(;G<a.length;){const k=c[G]||_;if(K+k>A){t(9,u=G),t(6,H=K);break}K+=k,G+=1}for(;G<a.length&&(K+=c[G]||_,G+=1,!(K>A+w)););t(10,m=G);const J=a.length-m;for(_=K/m;G<a.length;)c[G++]=_;if(t(7,S=J*_),u<U){await Vt();let k=0,O=0;for(let ke=u;ke<U;ke+=1)h[ke-u]&&(k+=c[ke],O+=o||h[ke-u].offsetHeight);const re=O-k;d.scrollTo(0,A+re)}}ft(()=>{h=y.getElementsByTagName("svelte-virtual-list-row"),t(13,C=!0)});function te(A){Se[A?"unshift":"push"](()=>{y=A,t(4,y)})}function j(A){Se[A?"unshift":"push"](()=>{d=A,t(3,d)})}function P(){w=this.offsetHeight,t(2,w)}return l.$$set=A=>{"items"in A&&t(11,a=A.items),"height"in A&&t(0,s=A.height),"itemHeight"in A&&t(12,o=A.itemHeight),"hoverItemIndex"in A&&t(1,r=A.hoverItemIndex),"start"in A&&t(9,u=A.start),"end"in A&&t(10,m=A.end),"$$scope"in A&&t(14,n=A.$$scope)},l.$$.update=()=>{l.$$.dirty&3584&&t(5,p=a.slice(u,m).map((A,U)=>({index:U+u,data:A}))),l.$$.dirty&14340&&C&&T(a,w,o)},[s,r,w,d,y,p,H,S,X,u,m,a,o,C,n,i,te,j,P]}class Ki extends We{constructor(e){super(),Ue(this,e,Ui,Wi,Ke,{items:11,height:0,itemHeight:12,hoverItemIndex:1,start:9,end:10})}}function qi(l){let e,t;return{c(){e=rt("svg"),t=rt("path"),this.h()},l(i){e=ot(i,"svg",{width:!0,height:!0,viewBox:!0,focusable:!0,"aria-hidden":!0,role:!0});var n=M(e);t=ot(n,"path",{fill:!0,d:!0}),M(t).forEach(g),n.forEach(g),this.h()},h(){b(t,"fill","currentColor"),b(t,"d",`M34.923,37.251L24,26.328L13.077,37.251L9.436,33.61l10.923-10.923L9.436,11.765l3.641-3.641L24,19.047L34.923,8.124
    l3.641,3.641L27.641,22.688L38.564,33.61L34.923,37.251z`),b(e,"width","100%"),b(e,"height","100%"),b(e,"viewBox","-2 -2 50 50"),b(e,"focusable","false"),b(e,"aria-hidden","true"),b(e,"role","presentation")},m(i,n){D(i,e,n),L(e,t)},p:me,i:me,o:me,d(i){i&&g(e)}}}class Ji extends We{constructor(e){super(),Ue(this,e,null,qi,Ke,{})}}function Zi(l,e,t){let i;return function(){let a=this,s=arguments,o=function(){i=null,t||l.apply(a,s)},r=t&&!i;clearTimeout(i),i=setTimeout(o,e),r&&l.apply(a,s)}}function fl(l,e,t){const i=l.slice();return i[103]=e[t],i}function cl(l){let e,t,i,n,a;return{c(){e=V("span"),t=ce(l[33]),i=Z(),n=V("span"),a=ce(l[32]),this.h()},l(s){e=N(s,"SPAN",{id:!0});var o=M(e);t=de(o,l[33]),o.forEach(g),i=Y(s),n=N(s,"SPAN",{id:!0});var r=M(n);a=de(r,l[32]),r.forEach(g),this.h()},h(){b(e,"id","aria-selection"),b(n,"id","aria-context")},m(s,o){D(s,e,o),L(e,t),D(s,i,o),D(s,n,o),L(n,a)},p(s,o){o[1]&4&&It(t,s[33]),o[1]&2&&It(a,s[32])},d(s){s&&g(e),s&&g(i),s&&g(n)}}}function dl(l){let e,t,i;const n=[l[18]];var a=l[17];function s(o){let r={};for(let u=0;u<n.length;u+=1)r=Jt(r,n[u]);return{props:r}}return a&&(e=Te(a,s())),{c(){e&&ne(e.$$.fragment),t=ye()},l(o){e&&be(e.$$.fragment,o),t=ye()},m(o,r){e&&se(e,o,r),D(o,t,r),i=!0},p(o,r){const u=r[0]&262144?Zt(n,[Tl(o[18])]):{};if(a!==(a=o[17])){if(e){ve();const m=e;z(m.$$.fragment,1,0,()=>{ae(m,1)}),pe()}a?(e=Te(a,s()),ne(e.$$.fragment),B(e.$$.fragment,1),se(e,t.parentNode,t)):e=null}else a&&e.$set(u)},i(o){i||(e&&B(e.$$.fragment,o),i=!0)},o(o){e&&z(e.$$.fragment,o),i=!1},d(o){o&&g(t),e&&ae(e,o)}}}function hl(l){let e,t,i;var n=l[26];function a(s){return{props:{value:s[2],getSelectionLabel:s[12],activeValue:s[30],isDisabled:s[9],multiFullItemClearable:s[8]}}}return n&&(e=Te(n,a(l)),e.$on("multiItemClear",l[38]),e.$on("focus",l[40])),{c(){e&&ne(e.$$.fragment),t=ye()},l(s){e&&be(e.$$.fragment,s),t=ye()},m(s,o){e&&se(e,s,o),D(s,t,o),i=!0},p(s,o){const r={};if(o[0]&4&&(r.value=s[2]),o[0]&4096&&(r.getSelectionLabel=s[12]),o[0]&1073741824&&(r.activeValue=s[30]),o[0]&512&&(r.isDisabled=s[9]),o[0]&256&&(r.multiFullItemClearable=s[8]),n!==(n=s[26])){if(e){ve();const u=e;z(u.$$.fragment,1,0,()=>{ae(u,1)}),pe()}n?(e=Te(n,a(s)),e.$on("multiItemClear",s[38]),e.$on("focus",s[40]),ne(e.$$.fragment),B(e.$$.fragment,1),se(e,t.parentNode,t)):e=null}else n&&e.$set(r)},i(s){i||(e&&B(e.$$.fragment,s),i=!0)},o(s){e&&z(e.$$.fragment,s),i=!1},d(s){s&&g(t),e&&ae(e,s)}}}function ml(l){let e,t,i,n,a;var s=l[25];function o(r){return{props:{item:r[2],getSelectionLabel:r[12]}}}return s&&(t=Te(s,o(l))),{c(){e=V("div"),t&&ne(t.$$.fragment),this.h()},l(r){e=N(r,"DIV",{class:!0});var u=M(e);t&&be(t.$$.fragment,u),u.forEach(g),this.h()},h(){b(e,"class","selectedItem svelte-17l1npl")},m(r,u){D(r,e,u),t&&se(t,e,null),i=!0,n||(a=x(e,"focus",l[40]),n=!0)},p(r,u){const m={};if(u[0]&4&&(m.item=r[2]),u[0]&4096&&(m.getSelectionLabel=r[12]),s!==(s=r[25])){if(t){ve();const c=t;z(c.$$.fragment,1,0,()=>{ae(c,1)}),pe()}s?(t=Te(s,o(r)),ne(t.$$.fragment),B(t.$$.fragment,1),se(t,e,null)):t=null}else s&&t.$set(m)},i(r){i||(t&&B(t.$$.fragment,r),i=!0)},o(r){t&&z(t.$$.fragment,r),i=!1},d(r){r&&g(e),t&&ae(t),n=!1,a()}}}function _l(l){let e,t,i,n,a;var s=l[23];function o(r){return{}}return s&&(t=Te(s,o())),{c(){e=V("div"),t&&ne(t.$$.fragment),this.h()},l(r){e=N(r,"DIV",{class:!0,"aria-hidden":!0});var u=M(e);t&&be(t.$$.fragment,u),u.forEach(g),this.h()},h(){b(e,"class","clearSelect svelte-17l1npl"),b(e,"aria-hidden","true")},m(r,u){D(r,e,u),t&&se(t,e,null),i=!0,n||(a=x(e,"click",ni(l[27])),n=!0)},p(r,u){if(s!==(s=r[23])){if(t){ve();const m=t;z(m.$$.fragment,1,0,()=>{ae(m,1)}),pe()}s?(t=Te(s,o()),ne(t.$$.fragment),B(t.$$.fragment,1),se(t,e,null)):t=null}},i(r){i||(t&&B(t.$$.fragment,r),i=!0)},o(r){t&&z(t.$$.fragment,r),i=!1},d(r){r&&g(e),t&&ae(t),n=!1,a()}}}function gl(l){let e;function t(a,s){return a[22]?Qi:Yi}let i=t(l),n=i(l);return{c(){e=V("div"),n.c(),this.h()},l(a){e=N(a,"DIV",{class:!0,"aria-hidden":!0});var s=M(e);n.l(s),s.forEach(g),this.h()},h(){b(e,"class","indicator svelte-17l1npl"),b(e,"aria-hidden","true")},m(a,s){D(a,e,s),n.m(e,null)},p(a,s){i===(i=t(a))&&n?n.p(a,s):(n.d(1),n=i(a),n&&(n.c(),n.m(e,null)))},d(a){a&&g(e),n.d()}}}function Yi(l){let e,t;return{c(){e=rt("svg"),t=rt("path"),this.h()},l(i){e=ot(i,"svg",{width:!0,height:!0,viewBox:!0,focusable:!0,"aria-hidden":!0,class:!0});var n=M(e);t=ot(n,"path",{d:!0}),M(t).forEach(g),n.forEach(g),this.h()},h(){b(t,"d",`M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747
          3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0
          1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502
          0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0
          0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z`),b(e,"width","100%"),b(e,"height","100%"),b(e,"viewBox","0 0 20 20"),b(e,"focusable","false"),b(e,"aria-hidden","true"),b(e,"class","svelte-17l1npl")},m(i,n){D(i,e,n),L(e,t)},p:me,d(i){i&&g(e)}}}function Qi(l){let e,t;return{c(){e=new si(!1),t=ye(),this.h()},l(i){e=ai(i,!1),t=ye(),this.h()},h(){e.a=t},m(i,n){e.m(l[22],i,n),D(i,t,n)},p(i,n){n[0]&4194304&&e.p(i[22])},d(i){i&&g(t),i&&e.d()}}}function bl(l){let e,t,i;return{c(){e=V("div"),t=rt("svg"),i=rt("circle"),this.h()},l(n){e=N(n,"DIV",{class:!0});var a=M(e);t=ot(a,"svg",{class:!0,viewBox:!0});var s=M(t);i=ot(s,"circle",{class:!0,cx:!0,cy:!0,r:!0,fill:!0,stroke:!0,"stroke-width":!0,"stroke-miterlimit":!0}),M(i).forEach(g),s.forEach(g),a.forEach(g),this.h()},h(){b(i,"class","spinner_path svelte-17l1npl"),b(i,"cx","50"),b(i,"cy","50"),b(i,"r","20"),b(i,"fill","none"),b(i,"stroke","currentColor"),b(i,"stroke-width","5"),b(i,"stroke-miterlimit","10"),b(t,"class","spinner_icon svelte-17l1npl"),b(t,"viewBox","25 25 50 50"),b(e,"class","spinner svelte-17l1npl")},m(n,a){D(n,e,a),L(e,t),L(t,i)},d(n){n&&g(e)}}}function vl(l){let e,t,i,n;const a=[l[34]];function s(u){l[84](u)}var o=l[24];function r(u){let m={};for(let c=0;c<a.length;c+=1)m=Jt(m,a[c]);return u[28]!==void 0&&(m.hoverItemIndex=u[28]),{props:m}}return o&&(e=Te(o,r(l)),Se.push(()=>Qe(e,"hoverItemIndex",s)),e.$on("itemSelected",l[43]),e.$on("itemCreated",l[44]),e.$on("closeList",l[45])),{c(){e&&ne(e.$$.fragment),i=ye()},l(u){e&&be(e.$$.fragment,u),i=ye()},m(u,m){e&&se(e,u,m),D(u,i,m),n=!0},p(u,m){const c=m[1]&8?Zt(a,[Tl(u[34])]):{};if(!t&&m[0]&268435456&&(t=!0,c.hoverItemIndex=u[28],it(()=>t=!1)),o!==(o=u[24])){if(e){ve();const h=e;z(h.$$.fragment,1,0,()=>{ae(h,1)}),pe()}o?(e=Te(o,r(u)),Se.push(()=>Qe(e,"hoverItemIndex",s)),e.$on("itemSelected",u[43]),e.$on("itemCreated",u[44]),e.$on("closeList",u[45]),ne(e.$$.fragment),B(e.$$.fragment,1),se(e,i.parentNode,i)):e=null}else o&&e.$set(c)},i(u){n||(e&&B(e.$$.fragment,u),n=!0)},o(u){e&&z(e.$$.fragment,u),n=!1},d(u){u&&g(i),e&&ae(e,u)}}}function pl(l){let e,t,i;return{c(){e=V("input"),this.h()},l(n){e=N(n,"INPUT",{name:!0,type:!0,class:!0}),this.h()},h(){b(e,"name",t=l[16].name),b(e,"type","hidden"),e.value=i=l[2]?l[12](l[2]):null,b(e,"class","svelte-17l1npl")},m(n,a){D(n,e,a)},p(n,a){a[0]&65536&&t!==(t=n[16].name)&&b(e,"name",t),a[0]&4100&&i!==(i=n[2]?n[12](n[2]):null)&&(e.value=i)},d(n){n&&g(e)}}}function yl(l){let e,t=l[2],i=[];for(let n=0;n<t.length;n+=1)i[n]=wl(fl(l,t,n));return{c(){for(let n=0;n<i.length;n+=1)i[n].c();e=ye()},l(n){for(let a=0;a<i.length;a+=1)i[a].l(n);e=ye()},m(n,a){for(let s=0;s<i.length;s+=1)i[s].m(n,a);D(n,e,a)},p(n,a){if(a[0]&69636){t=n[2];let s;for(s=0;s<t.length;s+=1){const o=fl(n,t,s);i[s]?i[s].p(o,a):(i[s]=wl(o),i[s].c(),i[s].m(e.parentNode,e))}for(;s<i.length;s+=1)i[s].d(1);i.length=t.length}},d(n){Bt(i,n),n&&g(e)}}}function wl(l){let e,t,i;return{c(){e=V("input"),this.h()},l(n){e=N(n,"INPUT",{name:!0,type:!0,class:!0}),this.h()},h(){b(e,"name",t=l[16].name),b(e,"type","hidden"),e.value=i=l[103]?l[12](l[103]):null,b(e,"class","svelte-17l1npl")},m(n,a){D(n,e,a)},p(n,a){a[0]&65536&&t!==(t=n[16].name)&&b(e,"name",t),a[0]&4100&&i!==(i=n[103]?n[12](n[103]):null)&&(e.value=i)},d(n){n&&g(e)}}}function Xi(l){let e,t,i,n,a,s,o,r,u,m,c,h,d,y,w,p,C,H,S=l[1]&&cl(l),_=l[17]&&dl(l),T=l[35]&&hl(l),X=[{readOnly:o=!l[13]},l[31],{placeholder:l[36]},{style:l[14]},{disabled:l[9]}],te={};for(let k=0;k<X.length;k+=1)te=Jt(te,X[k]);let j=!l[7]&&l[29]&&ml(l),P=l[37]&&_l(l),A=!l[37]&&(l[20]||l[19]&&!l[2]||!l[13]&&!l[9]&&!l[4]&&(l[29]&&!l[15]||!l[29]))&&gl(l),U=l[4]&&bl(),G=l[5]&&vl(l),K=(!l[7]||l[7]&&!l[35])&&pl(l),J=l[7]&&l[35]&&yl(l);return{c(){e=V("div"),t=V("span"),S&&S.c(),i=Z(),_&&_.c(),n=Z(),T&&T.c(),a=Z(),s=V("input"),r=Z(),j&&j.c(),u=Z(),P&&P.c(),m=Z(),A&&A.c(),c=Z(),U&&U.c(),h=Z(),G&&G.c(),d=Z(),K&&K.c(),y=Z(),J&&J.c(),this.h()},l(k){e=N(k,"DIV",{class:!0,style:!0});var O=M(e);t=N(O,"SPAN",{"aria-live":!0,"aria-atomic":!0,"aria-relevant":!0,class:!0});var re=M(t);S&&S.l(re),re.forEach(g),i=Y(O),_&&_.l(O),n=Y(O),T&&T.l(O),a=Y(O),s=N(O,"INPUT",{placeholder:!0,style:!0}),r=Y(O),j&&j.l(O),u=Y(O),P&&P.l(O),m=Y(O),A&&A.l(O),c=Y(O),U&&U.l(O),h=Y(O),G&&G.l(O),d=Y(O),K&&K.l(O),y=Y(O),J&&J.l(O),O.forEach(g),this.h()},h(){b(t,"aria-live","polite"),b(t,"aria-atomic","false"),b(t,"aria-relevant","additions text"),b(t,"class","a11yText svelte-17l1npl"),xt(s,te),fe(s,"svelte-17l1npl",!0),b(e,"class",w="selectContainer "+l[21]+" svelte-17l1npl"),b(e,"style",l[11]),fe(e,"hasError",l[10]),fe(e,"multiSelect",l[7]),fe(e,"disabled",l[9]),fe(e,"focused",l[1])},m(k,O){D(k,e,O),L(e,t),S&&S.m(t,null),L(e,i),_&&_.m(e,null),L(e,n),T&&T.m(e,null),L(e,a),L(e,s),s.autofocus&&s.focus(),l[82](s),ut(s,l[3]),L(e,r),j&&j.m(e,null),L(e,u),P&&P.m(e,null),L(e,m),A&&A.m(e,null),L(e,c),U&&U.m(e,null),L(e,h),G&&G.m(e,null),L(e,d),K&&K.m(e,null),L(e,y),J&&J.m(e,null),l[85](e),p=!0,C||(H=[x(window,"click",l[41]),x(window,"focusin",l[41]),x(window,"keydown",l[39]),x(s,"focus",l[40]),x(s,"input",l[83]),x(e,"click",l[42])],C=!0)},p(k,O){k[1]?S?S.p(k,O):(S=cl(k),S.c(),S.m(t,null)):S&&(S.d(1),S=null),k[17]?_?(_.p(k,O),O[0]&131072&&B(_,1)):(_=dl(k),_.c(),B(_,1),_.m(e,n)):_&&(ve(),z(_,1,1,()=>{_=null}),pe()),k[35]?T?(T.p(k,O),O[1]&16&&B(T,1)):(T=hl(k),T.c(),B(T,1),T.m(e,a)):T&&(ve(),z(T,1,1,()=>{T=null}),pe()),xt(s,te=Zt(X,[(!p||O[0]&8192&&o!==(o=!k[13]))&&{readOnly:o},O[1]&1&&k[31],(!p||O[1]&32)&&{placeholder:k[36]},(!p||O[0]&16384)&&{style:k[14]},(!p||O[0]&512)&&{disabled:k[9]}])),O[0]&8&&s.value!==k[3]&&ut(s,k[3]),fe(s,"svelte-17l1npl",!0),!k[7]&&k[29]?j?(j.p(k,O),O[0]&536871040&&B(j,1)):(j=ml(k),j.c(),B(j,1),j.m(e,u)):j&&(ve(),z(j,1,1,()=>{j=null}),pe()),k[37]?P?(P.p(k,O),O[1]&64&&B(P,1)):(P=_l(k),P.c(),B(P,1),P.m(e,m)):P&&(ve(),z(P,1,1,()=>{P=null}),pe()),!k[37]&&(k[20]||k[19]&&!k[2]||!k[13]&&!k[9]&&!k[4]&&(k[29]&&!k[15]||!k[29]))?A?A.p(k,O):(A=gl(k),A.c(),A.m(e,c)):A&&(A.d(1),A=null),k[4]?U||(U=bl(),U.c(),U.m(e,h)):U&&(U.d(1),U=null),k[5]?G?(G.p(k,O),O[0]&32&&B(G,1)):(G=vl(k),G.c(),B(G,1),G.m(e,d)):G&&(ve(),z(G,1,1,()=>{G=null}),pe()),!k[7]||k[7]&&!k[35]?K?K.p(k,O):(K=pl(k),K.c(),K.m(e,y)):K&&(K.d(1),K=null),k[7]&&k[35]?J?J.p(k,O):(J=yl(k),J.c(),J.m(e,null)):J&&(J.d(1),J=null),(!p||O[0]&2097152&&w!==(w="selectContainer "+k[21]+" svelte-17l1npl"))&&b(e,"class",w),(!p||O[0]&2048)&&b(e,"style",k[11]),(!p||O[0]&2098176)&&fe(e,"hasError",k[10]),(!p||O[0]&2097280)&&fe(e,"multiSelect",k[7]),(!p||O[0]&2097664)&&fe(e,"disabled",k[9]),(!p||O[0]&2097154)&&fe(e,"focused",k[1])},i(k){p||(B(_),B(T),B(j),B(P),B(G),p=!0)},o(k){z(_),z(T),z(j),z(P),z(G),p=!1},d(k){k&&g(e),S&&S.d(),_&&_.d(),T&&T.d(),l[82](null),j&&j.d(),P&&P.d(),A&&A.d(),U&&U.d(),G&&G.d(),K&&K.d(),J&&J.d(),l[85](null),C=!1,xe(H)}}}function Sl(l){return l.map((e,t)=>({index:t,value:e,label:`${e}`}))}function xi(l,e,t){let i,n,a,s,o,r,u,m;const c=Lt();let{id:h=null}=e,{container:d=void 0}=e,{input:y=void 0}=e,{isMulti:w=!1}=e,{multiFullItemClearable:p=!1}=e,{isDisabled:C=!1}=e,{isCreatable:H=!1}=e,{isFocused:S=!1}=e,{value:_=null}=e,{filterText:T=""}=e,{placeholder:X="Select..."}=e,{placeholderAlwaysShow:te=!1}=e,{items:j=null}=e,{itemFilter:P=(f,W,ue)=>`${f}`.toLowerCase().includes(W.toLowerCase())}=e,{groupBy:A=void 0}=e,{groupFilter:U=f=>f}=e,{isGroupHeaderSelectable:G=!1}=e,{getGroupHeaderLabel:K=f=>f[J]||f.id}=e,{labelIdentifier:J="label"}=e,{getOptionLabel:k=(f,W)=>f.isCreator?`Create "${W}"`:f[J]}=e,{optionIdentifier:O="value"}=e,{loadOptions:re=void 0}=e,{hasError:ke=!1}=e,{containerStyles:we=""}=e,{getSelectionLabel:Ie=f=>f?f[J]:null}=e,{createGroupHeaderItem:Fe=f=>({value:f,label:f})}=e,{createItem:_e=f=>({value:f,label:f})}=e;const Me=()=>i;let{isSearchable:ge=!0}=e,{inputStyles:Ce=""}=e,{isClearable:Ee=!0}=e,{isWaiting:Ve=!1}=e,{listPlacement:I="auto"}=e,{listOpen:R=!1}=e,{isVirtualList:F=!1}=e,{loadOptionsInterval:he=300}=e,{noOptionsMessage:ee="No options"}=e,{hideEmptyState:q=!1}=e,{inputAttributes:$={}}=e,{listAutoWidth:ie=!0}=e,{itemHeight:Ye=40}=e,{Icon:De=void 0}=e,{iconProps:je={}}=e,{showChevron:v=!1}=e,{showIndicator:Le=!1}=e,{containerClasses:$e=""}=e,{indicatorSvg:qe=void 0}=e,{listOffset:gt=5}=e,{ClearIcon:pt=Ji}=e,{Item:Ge=Al}=e,{List:yt=Mi}=e,{Selection:wt=Hi}=e,{MultiSelection:ct=ji}=e,{VirtualList:Ne=Ki}=e;function E(f){if(f.loadOptions&&f.filterText.length>0)return;if(!f.items)return[];f.items&&f.items.length>0&&typeof f.items[0]!="object"&&(f.items=Sl(f.items));let W=f.items.filter(ue=>{let Re=P(k(ue,f.filterText),f.filterText,ue);return Re&&f.isMulti&&f.value&&Array.isArray(f.value)&&(Re=!f.value.some(dt=>dt[f.optionIdentifier]===ue[f.optionIdentifier])),Re});return f.groupBy&&(W=Ot(W)),f.isCreatable&&(W=Q(W,f.filterText)),W}function Q(f,W){if(W.length===0)return f;const ue=_e(W);return f[0]&&W===f[0][J]?f:(ue.isCreator=!0,[...f,ue])}let{selectedValue:Be=null}=e,le,He,oe,et,bt,nt;const Et=Zi(async()=>{t(4,Ve=!0);let f=await re(T).catch(W=>{console.warn("svelte-select loadOptions error :>> ",W),c("error",{type:"loadOptions",details:W})});f&&!f.cancelled&&(f?(f&&f.length>0&&typeof f[0]!="object"&&(f=Sl(f)),t(81,i=[...f]),c("loaded",{items:i})):t(81,i=[]),H&&t(81,i=Q(i,T)),t(4,Ve=!1),t(1,S=!0),t(5,R=!0))},he);function Ct(){typeof _=="string"?t(2,_={[O]:_,label:_}):w&&Array.isArray(_)&&_.length>0&&t(2,_=_.map(f=>typeof f=="string"?{value:f,label:f}:f))}let Je;function st(){t(31,Je=Object.assign({autocapitalize:"none",autocomplete:"off",autocorrect:"off",spellcheck:!1,tabindex:0,type:"text","aria-autocomplete":"list"},$)),h&&t(31,Je.id=h,Je),ge||t(31,Je.readonly=!0,Je)}function Ot(f){const W=[],ue={};f.forEach(dt=>{const tt=A(dt);W.includes(tt)||(W.push(tt),ue[tt]=[],tt&&ue[tt].push(Object.assign(Fe(tt,dt),{id:tt,isGroupHeader:!0,isSelectable:G}))),ue[tt].push(Object.assign({isGroupItem:!!tt},dt))});const Re=[];return U(W).forEach(dt=>{Re.push(...ue[dt])}),Re}function at(){if(w){JSON.stringify(_)!==JSON.stringify(He)&&Yt()&&c("select",_);return}(!He||JSON.stringify(_[O])!==JSON.stringify(He[O]))&&c("select",_)}function vt(){S||R?Ht():y&&y.blur()}function Tt(){_&&(Array.isArray(_)?t(2,_=[..._]):t(2,_=[_]))}function St(){_&&t(2,_=null)}function Dl(){T.length!==0&&(t(1,S=!0),t(5,R=!0),re?Et():(t(5,R=!0),w&&t(30,le=void 0)))}Ol(async()=>{t(77,He=_),t(78,oe=T),t(79,et=S),t(80,bt=w)});function Yt(){let f=!0;if(_){const W=[],ue=[];_.forEach(Re=>{W.includes(Re[O])?f=!1:(W.push(Re[O]),ue.push(Re))}),f||t(2,_=ue)}return f}function Qt(f){let W=f?f[O]:_[O];return j.find(ue=>ue[O]===W)}function Bl(f){!f||f.length===0||f.some(W=>typeof W!="object")||!_||(w?_.some(W=>!W||!W[O]):!_[O])||(Array.isArray(_)?t(2,_=_.map(W=>Qt(W)||W)):t(2,_=Qt()||_))}function Xt(f){const{detail:W}=f,ue=_[W?W.i:_.length-1];_.length===1?t(2,_=void 0):t(2,_=_.filter(Re=>Re!==ue)),c("clear",ue)}function Hl(f){if(!!S)switch(f.key){case"ArrowDown":f.preventDefault(),t(5,R=!0),t(30,le=void 0);break;case"ArrowUp":f.preventDefault(),t(5,R=!0),t(30,le=void 0);break;case"Tab":R||t(1,S=!1);break;case"Backspace":if(!w||T.length>0)return;if(w&&_&&_.length>0){if(Xt(le!==void 0?le:_.length-1),le===0||le===void 0)break;t(30,le=_.length>le?le-1:void 0)}break;case"ArrowLeft":if(!w||T.length>0)return;le===void 0?t(30,le=_.length-1):_.length>le&&le!==0&&t(30,le-=1);break;case"ArrowRight":if(!w||T.length>0||le===void 0)return;le===_.length-1?t(30,le=void 0):le<_.length-1&&t(30,le+=1);break}}function Ht(){t(1,S=!0),y&&y.focus()}function Pl(f){if(!d)return;const W=f.path&&f.path.length>0?f.path[0]:f.target;d.contains(W)||d.contains(f.relatedTarget)||(t(1,S=!1),t(5,R=!1),t(30,le=void 0),y&&y.blur())}function zl(){C||(t(1,S=!0),t(5,R=!R))}function jl(){t(2,_=void 0),t(5,R=!1),c("clear",_),Ht()}ft(()=>{S&&y&&y.focus()});function Gl(f){const{detail:W}=f;if(W){t(3,T="");const ue=Object.assign({},W);(!ue.isGroupHeader||ue.isSelectable)&&(w?t(2,_=_?_.concat([ue]):[ue]):t(2,_=ue),t(2,_),setTimeout(()=>{t(5,R=!1),t(30,le=void 0)}))}}function Rl(f){const{detail:W}=f;w?(t(2,_=_||[]),t(2,_=[..._,_e(W)])):t(2,_=_e(W)),c("itemCreated",W),t(3,T=""),t(5,R=!1),t(30,le=void 0)}function Wl(){t(3,T=""),t(5,R=!1)}let{ariaValues:Pt=f=>`Option ${f}, selected.`}=e,{ariaListOpen:zt=(f,W)=>`You are currently focused on option ${f}. There are ${W} results available.`}=e,{ariaFocused:jt=()=>"Select is focused, type to refine list, press down to open the menu."}=e;function Ul(){let f;return w&&_.length>0?f=_.map(W=>Ie(W)).join(", "):f=Ie(_),Pt(f)}function Kl(){if(!S||!i||i.length===0)return"";let f=i[nt];if(R&&f){let W=Ie(f),ue=i?i.length:0;return zt(W,ue)}else return jt()}function ql(f){Se[f?"unshift":"push"](()=>{y=f,t(6,y)})}function Jl(){T=this.value,t(3,T)}function Zl(f){nt=f,t(28,nt)}function Yl(f){Se[f?"unshift":"push"](()=>{d=f,t(0,d)})}return l.$$set=f=>{"id"in f&&t(46,h=f.id),"container"in f&&t(0,d=f.container),"input"in f&&t(6,y=f.input),"isMulti"in f&&t(7,w=f.isMulti),"multiFullItemClearable"in f&&t(8,p=f.multiFullItemClearable),"isDisabled"in f&&t(9,C=f.isDisabled),"isCreatable"in f&&t(47,H=f.isCreatable),"isFocused"in f&&t(1,S=f.isFocused),"value"in f&&t(2,_=f.value),"filterText"in f&&t(3,T=f.filterText),"placeholder"in f&&t(48,X=f.placeholder),"placeholderAlwaysShow"in f&&t(49,te=f.placeholderAlwaysShow),"items"in f&&t(50,j=f.items),"itemFilter"in f&&t(51,P=f.itemFilter),"groupBy"in f&&t(52,A=f.groupBy),"groupFilter"in f&&t(53,U=f.groupFilter),"isGroupHeaderSelectable"in f&&t(54,G=f.isGroupHeaderSelectable),"getGroupHeaderLabel"in f&&t(55,K=f.getGroupHeaderLabel),"labelIdentifier"in f&&t(56,J=f.labelIdentifier),"getOptionLabel"in f&&t(57,k=f.getOptionLabel),"optionIdentifier"in f&&t(58,O=f.optionIdentifier),"loadOptions"in f&&t(59,re=f.loadOptions),"hasError"in f&&t(10,ke=f.hasError),"containerStyles"in f&&t(11,we=f.containerStyles),"getSelectionLabel"in f&&t(12,Ie=f.getSelectionLabel),"createGroupHeaderItem"in f&&t(60,Fe=f.createGroupHeaderItem),"createItem"in f&&t(61,_e=f.createItem),"isSearchable"in f&&t(13,ge=f.isSearchable),"inputStyles"in f&&t(14,Ce=f.inputStyles),"isClearable"in f&&t(15,Ee=f.isClearable),"isWaiting"in f&&t(4,Ve=f.isWaiting),"listPlacement"in f&&t(63,I=f.listPlacement),"listOpen"in f&&t(5,R=f.listOpen),"isVirtualList"in f&&t(64,F=f.isVirtualList),"loadOptionsInterval"in f&&t(65,he=f.loadOptionsInterval),"noOptionsMessage"in f&&t(66,ee=f.noOptionsMessage),"hideEmptyState"in f&&t(67,q=f.hideEmptyState),"inputAttributes"in f&&t(16,$=f.inputAttributes),"listAutoWidth"in f&&t(68,ie=f.listAutoWidth),"itemHeight"in f&&t(69,Ye=f.itemHeight),"Icon"in f&&t(17,De=f.Icon),"iconProps"in f&&t(18,je=f.iconProps),"showChevron"in f&&t(19,v=f.showChevron),"showIndicator"in f&&t(20,Le=f.showIndicator),"containerClasses"in f&&t(21,$e=f.containerClasses),"indicatorSvg"in f&&t(22,qe=f.indicatorSvg),"listOffset"in f&&t(70,gt=f.listOffset),"ClearIcon"in f&&t(23,pt=f.ClearIcon),"Item"in f&&t(71,Ge=f.Item),"List"in f&&t(24,yt=f.List),"Selection"in f&&t(25,wt=f.Selection),"MultiSelection"in f&&t(26,ct=f.MultiSelection),"VirtualList"in f&&t(72,Ne=f.VirtualList),"selectedValue"in f&&t(73,Be=f.selectedValue),"ariaValues"in f&&t(74,Pt=f.ariaValues),"ariaListOpen"in f&&t(75,zt=f.ariaListOpen),"ariaFocused"in f&&t(76,jt=f.ariaFocused)},l.$$.update=()=>{l.$$.dirty[0]&140|l.$$.dirty[1]&405340160&&t(81,i=E({loadOptions:re,filterText:T,items:j,value:_,isMulti:w,optionIdentifier:O,groupBy:A,isCreatable:H})),l.$$.dirty[2]&2048&&Be&&console.warn("selectedValue is no longer used. Please use value instead."),l.$$.dirty[1]&524288&&Bl(j),l.$$.dirty[0]&4&&_&&Ct(),l.$$.dirty[0]&73728&&($||!ge)&&st(),l.$$.dirty[0]&128|l.$$.dirty[2]&262144&&(w&&Tt(),bt&&!w&&St()),l.$$.dirty[0]&132&&w&&_&&_.length>1&&Yt(),l.$$.dirty[0]&4&&_&&at(),l.$$.dirty[0]&132|l.$$.dirty[2]&32768&&!_&&w&&He&&c("select",_),l.$$.dirty[0]&2|l.$$.dirty[2]&131072&&S!==et&&vt(),l.$$.dirty[0]&8|l.$$.dirty[2]&65536&&T!==oe&&Dl(),l.$$.dirty[0]&12&&t(29,n=_&&T.length===0),l.$$.dirty[0]&536904208&&t(37,a=n&&Ee&&!C&&!Ve),l.$$.dirty[0]&132|l.$$.dirty[1]&393216&&t(36,s=te&&w?X:_?"":X),l.$$.dirty[0]&132&&t(35,o=w&&_&&_.length>0),l.$$.dirty[0]&141|l.$$.dirty[1]&218103808|l.$$.dirty[2]&526326&&t(34,r={Item:Ge,filterText:T,optionIdentifier:O,noOptionsMessage:ee,hideEmptyState:q,isVirtualList:F,VirtualList:Ne,value:_,isMulti:w,getGroupHeaderLabel:K,items:i,itemHeight:Ye,getOptionLabel:k,listPlacement:I,parent:d,listAutoWidth:ie,listOffset:gt}),l.$$.dirty[0]&132&&t(33,u=_?Ul():""),l.$$.dirty[0]&268435490|l.$$.dirty[2]&524288&&t(32,m=Kl())},[d,S,_,T,Ve,R,y,w,p,C,ke,we,Ie,ge,Ce,Ee,$,De,je,v,Le,$e,qe,pt,yt,wt,ct,jl,nt,n,le,Je,m,u,r,o,s,a,Xt,Hl,Ht,Pl,zl,Gl,Rl,Wl,h,H,X,te,j,P,A,U,G,K,J,k,O,re,Fe,_e,Me,I,F,he,ee,q,ie,Ye,gt,Ge,Ne,Be,Pt,zt,jt,He,oe,et,bt,i,ql,Jl,Zl,Yl]}class $i extends We{constructor(e){super(),Ue(this,e,xi,Xi,Ke,{id:46,container:0,input:6,isMulti:7,multiFullItemClearable:8,isDisabled:9,isCreatable:47,isFocused:1,value:2,filterText:3,placeholder:48,placeholderAlwaysShow:49,items:50,itemFilter:51,groupBy:52,groupFilter:53,isGroupHeaderSelectable:54,getGroupHeaderLabel:55,labelIdentifier:56,getOptionLabel:57,optionIdentifier:58,loadOptions:59,hasError:10,containerStyles:11,getSelectionLabel:12,createGroupHeaderItem:60,createItem:61,getFilteredItems:62,isSearchable:13,inputStyles:14,isClearable:15,isWaiting:4,listPlacement:63,listOpen:5,isVirtualList:64,loadOptionsInterval:65,noOptionsMessage:66,hideEmptyState:67,inputAttributes:16,listAutoWidth:68,itemHeight:69,Icon:17,iconProps:18,showChevron:19,showIndicator:20,containerClasses:21,indicatorSvg:22,listOffset:70,ClearIcon:23,Item:71,List:24,Selection:25,MultiSelection:26,VirtualList:72,selectedValue:73,handleClear:27,ariaValues:74,ariaListOpen:75,ariaFocused:76},null,[-1,-1,-1,-1])}get getFilteredItems(){return this.$$.ctx[62]}get handleClear(){return this.$$.ctx[27]}}function en(l){let e,t,i,n,a,s,o,r,u;function m(C){l[38](C)}function c(C){l[39](C)}function h(C){l[40](C)}function d(C){l[41](C)}function y(C){l[42](C)}function w(C){l[43](C)}let p={id:l[2],container:l[3],items:l[4],placeholder:l[5],isMulti:l[10],isSearchable:l[6],groupBy:l[20],loadOptions:l[9],getSelectionLabel:l[11],getOptionLabel:l[19],itemFilter:l[17],ariaValues:l[23],ariaListOpen:l[24],ariaFocused:l[25],noOptionsMessage:l[18],indicatorSvg:l[21],containerStyles:l[22],optionIdentifier:l[8],showIndicator:!0,isClearable:l[7]?!l[10]:!1};return l[14]!==void 0&&(p.isFocused=l[14]),l[0]!==void 0&&(p.value=l[0]),l[15]!==void 0&&(p.listOpen=l[15]),l[1]!==void 0&&(p.filterText=l[1]),l[12]!==void 0&&(p.isWaiting=l[12]),l[16]!==void 0&&(p.handleClear=l[16]),t=new $i({props:p}),Se.push(()=>Qe(t,"isFocused",m)),Se.push(()=>Qe(t,"value",c)),Se.push(()=>Qe(t,"listOpen",h)),Se.push(()=>Qe(t,"filterText",d)),Se.push(()=>Qe(t,"isWaiting",y)),Se.push(()=>Qe(t,"handleClear",w)),t.$on("select",l[26]),t.$on("clear",l[44]),t.$on("loaded",l[45]),t.$on("error",l[46]),{c(){e=V("div"),ne(t.$$.fragment),this.h()},l(C){e=N(C,"DIV",{class:!0});var H=M(e);be(t.$$.fragment,H),H.forEach(g),this.h()},h(){b(e,"class","selectbox svelte-x3pza0"),fe(e,"multi-selected",l[0]&&l[10]),fe(e,"focused",l[14]),fe(e,"selected",l[0]&&!l[15]&&!l[10])},m(C,H){D(C,e,H),se(t,e,null),l[47](e),u=!0},p(C,H){const S={};H[0]&4&&(S.id=C[2]),H[0]&8&&(S.container=C[3]),H[0]&16&&(S.items=C[4]),H[0]&32&&(S.placeholder=C[5]),H[0]&1024&&(S.isMulti=C[10]),H[0]&64&&(S.isSearchable=C[6]),H[0]&512&&(S.loadOptions=C[9]),H[0]&2048&&(S.getSelectionLabel=C[11]),H[0]&131072&&(S.itemFilter=C[17]),H[0]&262144&&(S.noOptionsMessage=C[18]),H[0]&256&&(S.optionIdentifier=C[8]),H[0]&1152&&(S.isClearable=C[7]?!C[10]:!1),!i&&H[0]&16384&&(i=!0,S.isFocused=C[14],it(()=>i=!1)),!n&&H[0]&1&&(n=!0,S.value=C[0],it(()=>n=!1)),!a&&H[0]&32768&&(a=!0,S.listOpen=C[15],it(()=>a=!1)),!s&&H[0]&2&&(s=!0,S.filterText=C[1],it(()=>s=!1)),!o&&H[0]&4096&&(o=!0,S.isWaiting=C[12],it(()=>o=!1)),!r&&H[0]&65536&&(r=!0,S.handleClear=C[16],it(()=>r=!1)),t.$set(S),(!u||H[0]&1025)&&fe(e,"multi-selected",C[0]&&C[10]),(!u||H[0]&16384)&&fe(e,"focused",C[14]),(!u||H[0]&33793)&&fe(e,"selected",C[0]&&!C[15]&&!C[10])},i(C){u||(B(t.$$.fragment,C),u=!0)},o(C){z(t.$$.fragment,C),u=!1},d(C){C&&g(e),ae(t),l[47](null)}}}function tn(l,e,t){let i,n;const a='<svg viewBox="0 0 20 20" fill-rule="evenodd"><path d="M0,8a8,8,0,1,0,16,0a8,8,0,1,0,-16,0ZM3,8a5,5,0,1,0,10,0a5,5,0,1,0,-10,0Z"/><path d="M18,20L20,18L14,12L12,14Z"/></svg>',s='<svg viewBox="0 0 20 20"><path d="M1,6L19,6L10,15Z"/></svg>',o=Lt();let{id:r=""}=e,{container:u=void 0}=e,{mode:m="default"}=e,{items:c}=e,{placeholder:h="Select one..."}=e,{value:d=null}=e,{filterText:y=""}=e,{isSearchable:w=!0}=e,{isClearable:p=!0}=e,{autoClear:C=!1}=e,{idKey:H="value"}=e,{labelKey:S="label"}=e,{groupKey:_=null}=e,{groupItems:T=!1}=e,{loadOptions:X=void 0}=e,{fontSize:te="1em"}=e,{height:j=42}=e,{isMulti:P=!1}=e,{maxSelected:A=4}=e,{colors:U=["#206095","#a8bd3a","#871a5b","#27a0cc"]}=e,{darkMode:G=!1}=e,{borderColor:K=G?"white":"#206095"}=e;const J=_&&!T?v=>`${v[S]} <span class="group">${v[_]}</span>`:v=>v[S];let{getSelectionLabel:k=v=>v?J(v):null}=e;const O=T&&_?v=>v[_]:void 0,re=m=="search"?a:s,ke=`--inputFontSize: ${te}; --groupTitleFontSize: ${te}; --height: ${j}px; font-size: ${te};`,we=v=>`${v}, selected.`,Ie=(v,Le)=>`You are currently focused on ${v}. There are ${Le} results available.`,Fe=()=>"Select is focused, type to refine list, press down to open the menu.";let _e,Me,ge,Ce,Ee;const Ve=v=>new Promise(Le=>setTimeout(Le,v));async function I(v){if(o("select",v.detail),C)Ee();else if(p){await Ve(10);let Le=_e.getElementsByClassName("clearSelect")[0];Le&&(Le.tabIndex=0,Le.onkeypress=$e=>{$e.key=="Enter"&&Ee()},Le.removeAttribute("aria-hidden"),Le.setAttribute("aria-label","Clear selection"))}}ft(()=>{let v=_e.style;v.setProperty("--firstItem",U[0%U.length]),v.setProperty("--secondItem",U[1%U.length]),v.setProperty("--thirdItem",U[2%U.length]),v.setProperty("--fourthItem",U[3%U.length]),v.setProperty("--borderColor",K)});function R(v){Me=v,t(14,Me)}function F(v){d=v,t(0,d)}function he(v){ge=v,t(15,ge)}function ee(v){y=v,t(1,y)}function q(v){Ce=v,t(12,Ce)}function $(v){Ee=v,t(16,Ee)}function ie(v){Gt.call(this,l,v)}function Ye(v){Gt.call(this,l,v)}function De(v){Gt.call(this,l,v)}function je(v){Se[v?"unshift":"push"](()=>{_e=v,t(13,_e)})}return l.$$set=v=>{"id"in v&&t(2,r=v.id),"container"in v&&t(3,u=v.container),"mode"in v&&t(27,m=v.mode),"items"in v&&t(4,c=v.items),"placeholder"in v&&t(5,h=v.placeholder),"value"in v&&t(0,d=v.value),"filterText"in v&&t(1,y=v.filterText),"isSearchable"in v&&t(6,w=v.isSearchable),"isClearable"in v&&t(7,p=v.isClearable),"autoClear"in v&&t(28,C=v.autoClear),"idKey"in v&&t(8,H=v.idKey),"labelKey"in v&&t(29,S=v.labelKey),"groupKey"in v&&t(30,_=v.groupKey),"groupItems"in v&&t(31,T=v.groupItems),"loadOptions"in v&&t(9,X=v.loadOptions),"fontSize"in v&&t(32,te=v.fontSize),"height"in v&&t(33,j=v.height),"isMulti"in v&&t(10,P=v.isMulti),"maxSelected"in v&&t(34,A=v.maxSelected),"colors"in v&&t(35,U=v.colors),"darkMode"in v&&t(36,G=v.darkMode),"borderColor"in v&&t(37,K=v.borderColor),"getSelectionLabel"in v&&t(11,k=v.getSelectionLabel)},l.$$.update=()=>{l.$$.dirty[0]&134221826&&t(18,i=Ce?"Loading...":m=="search"&&y.length<3?"Enter 3 or more characters for suggestions":`No results match ${y}`),l.$$.dirty[0]&134217731|l.$$.dirty[1]&8&&t(17,n=Array.isArray(d)&&d.length>=A||m=="search"&&y.length<3?(v,Le,$e)=>!1:(v,Le,$e)=>`${v}`.split("<")[0].toLowerCase().slice(0,Le.length)==Le.toLowerCase())},[d,y,r,u,c,h,w,p,H,X,P,k,Ce,_e,Me,ge,Ee,n,i,J,O,re,ke,we,Ie,Fe,I,m,C,S,_,T,te,j,A,U,G,K,R,F,he,ee,q,$,ie,Ye,De,je]}class ln extends We{constructor(e){super(),Ue(this,e,tn,en,Ke,{id:2,container:3,mode:27,items:4,placeholder:5,value:0,filterText:1,isSearchable:6,isClearable:7,autoClear:28,idKey:8,labelKey:29,groupKey:30,groupItems:31,loadOptions:9,fontSize:32,height:33,isMulti:10,maxSelected:34,colors:35,darkMode:36,borderColor:37,getSelectionLabel:11},null,[-1,-1])}}function kl(l){let e,t,i;function n(s){l[4](s)}let a={id:"select",mode:"search",idKey:"areacd",labelKey:"areanm",groupKey:"group",items:l[0],placeholder:un,loadOptions:l[2],autoClear:!0};return l[1]!==void 0&&(a.filterText=l[1]),e=new ln({props:a}),Se.push(()=>Qe(e,"filterText",n)),e.$on("select",l[3]),{c(){ne(e.$$.fragment)},l(s){be(e.$$.fragment,s)},m(s,o){se(e,s,o),i=!0},p(s,o){const r={};o&1&&(r.items=s[0]),!t&&o&2&&(t=!0,r.filterText=s[1],it(()=>t=!1)),e.$set(r)},i(s){i||(B(e.$$.fragment,s),i=!0)},o(s){z(e.$$.fragment,s),i=!1},d(s){ae(e,s)}}}function nn(l){let e,t,i=l[0]&&kl(l);return{c(){i&&i.c(),e=ye()},l(n){i&&i.l(n),e=ye()},m(n,a){i&&i.m(n,a),D(n,e,a),t=!0},p(n,[a]){n[0]?i?(i.p(n,a),a&1&&B(i,1)):(i=kl(n),i.c(),B(i,1),i.m(e.parentNode,e)):i&&(ve(),z(i,1,1,()=>{i=null}),pe())},i(n){t||(B(i),t=!0)},o(n){z(i),t=!1},d(n){i&&i.d(n),n&&g(e)}}}const Fl="https://cdn.ons.gov.uk/maptiles/cp-geos/v1",sn=[{keys:["E05","W05"],label:"Ward"},{keys:["E06","W06"],label:"Unitary authority"},{keys:["E07","E08"],label:"Local authority district"},{keys:["E09"],label:"London borough"},{keys:["E10"],label:"County"},{keys:["E11"],label:"Metropolitan county"},{keys:["E14","W07"],label:"Parliamentary constituency"},{keys:["E30","K01","W22"],label:"Travel to work area"},{keys:["E34","K05","W37"],label:"Built-up area"},{keys:["E35","K06","W38"],label:"Built-up area, sub-division"}];let Ml={};sn.forEach(l=>l.keys.forEach(e=>Ml[e]=l.label));async function an(l){let e=await dfd.readCSV(l,{skipEmptyLines:!0});return dfd.toJSON(e)}async function rn(){let l=await an(`${Fl}/places_list.csv`),e={};return l.forEach(t=>e[t.areacd]=t),l.forEach(t=>{let i=Ml[t.areacd.slice(0,3)];t.group=t.parent?`${i} in ${e[t.parent].areanm}`:i}),l.sort((t,i)=>t.areanm.localeCompare(i.areanm)),l}async function on(l){let e;try{e=await(await fetch(`${Fl}/${l.slice(0,3)}/${l}.json`)).json()}catch(t){return console.log(t),{type:null}}return{type:"place",areanm:e.properties.areanm,areacd:e.properties.areacd,geometry:e.geometry,bbox:e.properties.bounds,codes:e.properties.codes}}const un="Find an area or postcode";function fn(l,e,t){const i=Lt();let n,a;async function s(u){if(u.length>2&&/\d/.test(u)){let c=await(await fetch(`https://api.postcodes.io/postcodes/${u}/autocomplete`)).json();return c.result?c.result.map(h=>({areacd:h,areanm:h,group:"",postcode:!0})):[]}else if(u.length>2)return n.filter(m=>m.areanm.toLowerCase().slice(0,u.length)==u.toLowerCase());return[]}async function o(u){if(u.detail.postcode){let c=await(await fetch(`https://api.postcodes.io/postcodes/${u.detail.areacd}`)).json();c.result&&i("select",{type:"postcode",postcode:c.result.postcode,center:[c.result.longitude,c.result.latitude]})}else i("select",await on(u.detail.areacd))}ft(async()=>t(0,n=await rn()));function r(u){a=u,t(1,a)}return[n,a,s,o,r]}class cn extends We{constructor(e){super(),Ue(this,e,fn,nn,Ke,{})}}function dn(l){let e,t,i=`${l[4]}px`,n,a,s,o,r,u,m;return{c(){e=V("div"),t=V("input"),n=Z(),a=V("div"),s=V("div"),o=Z(),r=V("div"),this.h()},l(c){e=N(c,"DIV",{class:!0});var h=M(e);t=N(h,"INPUT",{type:!0,class:!0,min:!0,max:!0,step:!0}),n=Y(h),a=N(h,"DIV",{class:!0});var d=M(a);s=N(d,"DIV",{class:!0}),M(s).forEach(g),d.forEach(g),o=Y(h),r=N(h,"DIV",{class:!0}),M(r).forEach(g),h.forEach(g),this.h()},h(){b(t,"type","range"),b(t,"class","range svelte-ex8rah"),b(t,"min",l[1]),b(t,"max",l[2]),b(t,"step",l[3]),Oe(t,"width",i),b(s,"class","track-inner svelte-ex8rah"),b(a,"class","track svelte-ex8rah"),b(r,"class","thumb svelte-ex8rah"),b(e,"class","wrap svelte-ex8rah")},m(c,h){D(c,e,h),L(e,t),ut(t,l[0]),l[9](t),L(e,n),L(e,a),L(a,s),l[10](s),L(e,o),L(e,r),l[11](r),u||(m=[x(t,"change",l[8]),x(t,"input",l[8])],u=!0)},p(c,[h]){h&2&&b(t,"min",c[1]),h&4&&b(t,"max",c[2]),h&8&&b(t,"step",c[3]),h&1&&ut(t,c[0]),h&16&&i!==(i=`${c[4]}px`)&&Oe(t,"width",i)},i:me,o:me,d(c){c&&g(e),l[9](null),l[10](null),l[11](null),u=!1,xe(m)}}}function hn(l,e,t){let{min:i=.2}=e,{max:n=10}=e,{step:a=.1}=e,{value:s=5}=e,{width:o=200}=e,r,u,m;const c=p=>{if(u){let C=(p-i)/(n-i)*100;t(6,u.style.left=`${C}%`,u),t(6,u.style.transform=`translate(-${C}%, -50%)`,u),t(7,m.style.width=`${C}%`,m)}};ft(()=>{t(5,r.oninput=p=>c(p.target.value),r),c(s)});function h(){s=ri(this.value),t(0,s)}function d(p){Se[p?"unshift":"push"](()=>{r=p,t(5,r)})}function y(p){Se[p?"unshift":"push"](()=>{m=p,t(7,m)})}function w(p){Se[p?"unshift":"push"](()=>{u=p,t(6,u)})}return l.$$set=p=>{"min"in p&&t(1,i=p.min),"max"in p&&t(2,n=p.max),"step"in p&&t(3,a=p.step),"value"in p&&t(0,s=p.value),"width"in p&&t(4,o=p.width)},l.$$.update=()=>{l.$$.dirty&1&&c(s)},[s,i,n,a,o,r,u,m,h,d,y,w]}class mn extends We{constructor(e){super(),Ue(this,e,hn,dn,Ke,{min:1,max:2,step:3,value:0,width:4})}}function _n(l){let e;return{c(){e=V("div"),this.h()},l(t){e=N(t,"DIV",{tabindex:!0,"aria-label":!0,id:!0,class:!0}),M(e).forEach(g),this.h()},h(){b(e,"tabindex","0"),b(e,"aria-label","Map"),b(e,"id","mapcontainer"),b(e,"class","svelte-z19ft7")},m(t,i){D(t,e,i),l[3](e)},p:me,i:me,o:me,d(t){t&&g(e),l[3](null)}}}function gn(l,e,t){let i,n,a,s;ze(l,Kt,d=>t(4,i=d)),ze(l,Nt,d=>t(5,n=d)),ze(l,At,d=>t(6,a=d)),ze(l,Ft,d=>t(7,s=d));const o=ki;let r,{drawing_tools:u=!1}=e;async function m(){Ae(Kt,i=new o.Map({container:"mapcontainer",style:ci,minZoom:Vl,maxZoom:Nl,maxBounds:di,center:[0,51],zoom:4,hash:!1}),i),document.querySelector("#mapcontainer div canvas").style.cursor="wait",i.addControl(new o.ScaleControl({position:"bottom-left"})),i.addControl(new o.NavigationControl,"bottom-right"),i.doubleClickZoom.disable(),i.dragRotate.disable(),i.on("error",d=>{if(d.error.status!=403&&d.error.message!="Failed to fetch"&&!/CORS/.test(d.error.message))return console.error("--",d.error.status,d.error.message),d}),i.on("load",c)}async function c(){Ft.subscribe(async()=>{for(const[d,y]of Object.entries(s))i.getSource(d)&&i.removeSource(d),i.getSource(d)||i.addSource(d,y)}),At.subscribe(async()=>{for(const d of a)i.getLayer(d.id)&&i.removeLayer(d.id),i.addLayer(d)}),Nt.subscribe(async()=>{for(const d of n)i.on(d.event,d.layer,d.callback)}),u&&await hi()}ft(m);function h(d){Se[d?"unshift":"push"](()=>{r=d,t(0,r)})}return l.$$set=d=>{"drawing_tools"in d&&t(1,u=d.drawing_tools)},[r,u,c,h]}class bn extends We{constructor(e){super(),Ue(this,e,gn,_n,Ke,{drawing_tools:1,SetLayers:2})}get SetLayers(){return this.$$.ctx[2]}}class vn{async initialize({year:e,dfd:t}){this.file=`/oa${e}-data-v2.csv`,this.oa=`oa${e}cd`;var i=await t.readCSV(`/oa${e}-data.csv`);this.oalist=new Set(i[this.oa].$data),this.lsoa=this.count(i["ls"+this.oa]);var n=i.loc({columns:["ms"+this.oa,"ls"+this.oa]}).groupby(["ms"+this.oa]).count();this.msoa=Object.fromEntries(n.$data);var a=i.population;this.population=Object.fromEntries(i[this.oa].$data.map((s,o)=>[s,a.$data[o]]));var a=i[this.oa];this.index=Object.fromEntries(a.$index.map((s,o)=>[a.$data[o],s])),this.df=i}count(e){var t=e.valueCounts();return Object.fromEntries(t.$index.map((i,n)=>[i,t.$data[n]]))}parent(e){var t=this.df.loc({rows:this.indf([...e]),columns:["ls"+this.oa]}).$data;return e.length==1?t[0]:t}bounds(e){return this.getbbox(this.df.loc({rows:this.indf(e),columns:["lng","lat"]}).$data)}indf(e){return e.filter(t=>this.oalist.has(t)).map(t=>this.index[t])}async contains(e){let t=await this.getbbox(e);t=t.length==4?[[t[0],t[1]],[t[2],t[3]]]:t;try{var i,n,a,s;[i,n]=t[1].map(parseFloat),[a,s]=t[0].map(parseFloat);var o=await this.df.query(await this.df.lat.lt(n).and(await this.df.lng.lt(i)).and(await this.df.lat.gt(s)).and(await this.df.lng.gt(a)))}catch{var o=this.df}return{bbox:t,...this.inPolygon(e,o.$data)}}async simplify(e="Enter Area Name",t,i){const n=this.indf([...t.oa]),a=this.df.loc({rows:n,columns:[this.oa]}).$data.map(d=>d[0]);var s=await new Set(Object.entries(t.parents.reduce(function(d,y){return d[y]?++d[y]:d[y]=1,d},{})).filter(d=>this.lsoa[d[0]]===d[1]).map(d=>d[0])),o=await new Set(Object.entries([...s].reduce(function(d,y){return d[y]?++d[y]:d[y]=1,d},{})).filter(d=>this.msoa[d[0]]===d[1]).map(d=>d[0]));const r=await this.df.loc({rows:n,columns:[this.oa,"ls"+this.oa,"ms"+this.oa]}),u=r.$data.filter(d=>!s.has(d[1])).map(d=>d[0]);s=[...new Set(r.$data.filter(d=>!o.has(d[1])).map(d=>d[1]))],o=[...o];const m=this.bounds(a);var c={};c.properties={name:e,oa:u,lsoa:s,msoa:o,oa_all:a,original:a.length},i.fitBounds(m,{padding:20});var h=i.queryRenderedFeatures({layers:["bounds"]}).filter(d=>t.oa.has(d.properties.areacd));return c.geojson=mi({type:"FeatureCollection",features:h.map(d=>({type:d.type,geometry:d.geometry}))}),console.debug("---merge---",c),c}getbbox(e){var t=e.map(s=>+s[1]),i=e.map(s=>+s[0]),n=[Math.min.apply(null,i),Math.min.apply(null,t)],a=[Math.max.apply(null,i),Math.max.apply(null,t)];return[n,a]}inPolygon(e,t){const i=t.filter(n=>{const a=n.slice(3,5);if(!e.length)return!1;for(var s=e.length,o=e[s-1],[r,u]=a,[m,c]=o,h,d,y=!1,w=0;w<s;++w)o=e[w],h=o[0],d=o[1],d>u!=c>u&&r<(m-h)*(u-d)/(c-d)+h&&(y=!y),m=h,c=d;return y});return{oa:new Set(i.map(n=>n[0])),parents:i.map(n=>n[1])}}}async function pn(l){const e=new vn;return await e.initialize(l),e}const{document:Il}=fi;function Ll(l,e,t){const i=l.slice();return i[43]=e[t],i}function El(l){let e,t,i,n,a,s,o,r,u,m,c,h;s=new Xe({props:{type:l[43].key}});function d(){return l[19](l[43])}return{c(){e=V("label"),t=V("input"),a=Z(),ne(s.$$.fragment),o=Z(),this.h()},l(y){e=N(y,"LABEL",{id:!0,title:!0});var w=M(e);t=N(w,"INPUT",{type:!0,name:!0}),a=Y(w),be(s.$$.fragment,w),o=Y(w),w.forEach(g),this.h()},h(){b(t,"type","radio"),b(t,"name","mode"),t.__value=i=l[43].key,t.value=t.__value,t.disabled=n=l[2]<kt,l[18][0].push(t),b(e,"id",r="init_"+l[43].key),b(e,"title",u=l[43].label),fe(e,"active",l[1].mode==l[43].key),fe(e,"disabled",l[2]<kt),Oe(e,"filter","contrast(1.35)")},m(y,w){D(y,e,w),L(e,t),t.checked=t.__value===l[1].mode,L(e,a),se(s,e,null),L(e,o),m=!0,c||(h=[x(t,"change",l[17]),x(e,"click",d),ht(mt.call(null,e))],c=!0)},p(y,w){l=y,(!m||w[0]&128&&i!==(i=l[43].key))&&(t.__value=i,t.value=t.__value),(!m||w[0]&4&&n!==(n=l[2]<kt))&&(t.disabled=n),w[0]&2&&(t.checked=t.__value===l[1].mode);const p={};w[0]&128&&(p.type=l[43].key),s.$set(p),(!m||w[0]&128&&r!==(r="init_"+l[43].key))&&b(e,"id",r),(!m||w[0]&128&&u!==(u=l[43].label))&&b(e,"title",u),(!m||w[0]&130)&&fe(e,"active",l[1].mode==l[43].key),(!m||w[0]&4)&&fe(e,"disabled",l[2]<kt)},i(y){m||(B(s.$$.fragment,y),m=!0)},o(y){z(s.$$.fragment,y),m=!1},d(y){y&&g(e),l[18][0].splice(l[18][0].indexOf(t),1),ae(s),c=!1,xe(h)}}}function yn(l){let e,t,i,n;return{c(){e=V("button"),t=ce("Further Tools"),this.h()},l(a){e=N(a,"BUTTON",{class:!0});var s=M(e);t=de(s,"Further Tools"),s.forEach(g),this.h()},h(){b(e,"class","text secondary"),Oe(e,"color","lightgray"),Oe(e,"filter","invert(.2)contrast(2)")},m(a,s){D(a,e,s),L(e,t),i||(n=x(e,"click",l[21]),i=!0)},p:me,i:me,o:me,d(a){a&&g(e),i=!1,n()}}}function wn(l){let e,t,i,n,a,s;return t=new Xe({props:{type:"undo"}}),{c(){e=V("button"),ne(t.$$.fragment),this.h()},l(o){e=N(o,"BUTTON",{title:!0});var r=M(e);be(t.$$.fragment,r),r.forEach(g),this.h()},h(){b(e,"title","Undo last action"),e.disabled=i=l[8].length<2},m(o,r){D(o,e,r),se(t,e,null),n=!0,a||(s=[ht(mt.call(null,e)),x(e,"click",l[20])],a=!0)},p(o,r){(!n||r[0]&256&&i!==(i=o[8].length<2))&&(e.disabled=i)},i(o){n||(B(t.$$.fragment,o),n=!0)},o(o){z(t.$$.fragment,o),n=!1},d(o){o&&g(e),ae(t),a=!1,xe(s)}}}function Sn(l){let e,t,i,n,a,s,o,r,u,m,c,h,d,y,w,p,C,H,S=l[1].mode=="radius"&&Cl(l);return m=new Xe({props:{type:"select_add"}}),w=new Xe({props:{type:"select_subtract"}}),{c(){e=V("nav"),S&&S.c(),t=Z(),i=V("div"),n=V("span"),a=ce("Selection mode"),s=Z(),o=V("label"),r=V("input"),u=Z(),ne(m.$$.fragment),c=Z(),h=V("label"),d=V("input"),y=Z(),ne(w.$$.fragment),this.h()},l(_){e=N(_,"NAV",{class:!0});var T=M(e);S&&S.l(T),t=Y(T),i=N(T,"DIV",{class:!0});var X=M(i);n=N(X,"SPAN",{});var te=M(n);a=de(te,"Selection mode"),te.forEach(g),s=Y(X),o=N(X,"LABEL",{title:!0});var j=M(o);r=N(j,"INPUT",{type:!0,name:!0}),u=Y(j),be(m.$$.fragment,j),j.forEach(g),c=Y(X),h=N(X,"LABEL",{title:!0});var P=M(h);d=N(P,"INPUT",{type:!0,name:!0}),y=Y(P),be(w.$$.fragment,P),P.forEach(g),X.forEach(g),T.forEach(g),this.h()},h(){b(r,"type","radio"),b(r,"name","select"),r.__value="add",r.value=r.__value,l[18][1].push(r),b(o,"title","Add to selection"),fe(o,"active",l[1].select=="add"),b(d,"type","radio"),b(d,"name","select"),d.__value="subtract",d.value=d.__value,l[18][1].push(d),b(h,"title","Subtract from selection"),fe(h,"active",l[1].select=="subtract"),b(i,"class","select-mode"),b(e,"class","tray")},m(_,T){D(_,e,T),S&&S.m(e,null),L(e,t),L(e,i),L(i,n),L(n,a),L(i,s),L(i,o),L(o,r),r.checked=r.__value===l[1].select,L(o,u),se(m,o,null),L(i,c),L(i,h),L(h,d),d.checked=d.__value===l[1].select,L(h,y),se(w,h,null),p=!0,C||(H=[x(r,"click",l[30]),x(r,"change",l[31]),ht(mt.call(null,o)),x(d,"change",l[32]),x(d,"click",l[33]),ht(mt.call(null,h))],C=!0)},p(_,T){_[1].mode=="radius"?S?(S.p(_,T),T[0]&2&&B(S,1)):(S=Cl(_),S.c(),B(S,1),S.m(e,t)):S&&(ve(),z(S,1,1,()=>{S=null}),pe()),T[0]&2&&(r.checked=r.__value===_[1].select),(!p||T[0]&2)&&fe(o,"active",_[1].select=="add"),T[0]&2&&(d.checked=d.__value===_[1].select),(!p||T[0]&2)&&fe(h,"active",_[1].select=="subtract")},i(_){p||(B(S),B(m.$$.fragment,_),B(w.$$.fragment,_),p=!0)},o(_){z(S),z(m.$$.fragment,_),z(w.$$.fragment,_),p=!1},d(_){_&&g(e),S&&S.d(),l[18][1].splice(l[18][1].indexOf(r),1),ae(m),l[18][1].splice(l[18][1].indexOf(d),1),ae(w),C=!1,xe(H)}}}function kn(l){let e,t,i,n,a,s,o,r,u,m,c,h,d,y,w,p,C,H;return r=new Xe({props:{type:"download"}}),d=new Xe({props:{type:"copy"}}),{c(){e=V("nav"),t=V("div"),i=Z(),n=V("div"),a=V("input"),s=Z(),o=V("button"),ne(r.$$.fragment),u=V("span"),m=ce("Save geography"),c=Z(),h=V("button"),ne(d.$$.fragment),y=V("span"),w=ce("Copy area codes"),this.h()},l(S){e=N(S,"NAV",{class:!0});var _=M(e);t=N(_,"DIV",{}),M(t).forEach(g),i=Y(_),n=N(_,"DIV",{class:!0});var T=M(n);a=N(T,"INPUT",{type:!0,placeholder:!0}),s=Y(T),o=N(T,"BUTTON",{class:!0});var X=M(o);be(r.$$.fragment,X),u=N(X,"SPAN",{});var te=M(u);m=de(te,"Save geography"),te.forEach(g),X.forEach(g),c=Y(T),h=N(T,"BUTTON",{class:!0});var j=M(h);be(d.$$.fragment,j),y=N(j,"SPAN",{});var P=M(y);w=de(P,"Copy area codes"),P.forEach(g),j.forEach(g),T.forEach(g),_.forEach(g),this.h()},h(){b(a,"type","text"),b(a,"placeholder","Type a name"),b(o,"class","text"),b(h,"class","text"),b(n,"class","save-buttons"),b(e,"class","tray")},m(S,_){D(S,e,_),L(e,t),L(e,i),L(e,n),L(n,a),ut(a,l[1].name),L(n,s),L(n,o),se(r,o,null),L(o,u),L(u,m),L(n,c),L(n,h),se(d,h,null),L(h,y),L(y,w),p=!0,C||(H=[x(a,"input",l[25]),x(o,"click",l[26]),x(h,"click",l[27])],C=!0)},p(S,_){_[0]&2&&a.value!==S[1].name&&ut(a,S[1].name)},i(S){p||(B(r.$$.fragment,S),B(d.$$.fragment,S),p=!0)},o(S){z(r.$$.fragment,S),z(d.$$.fragment,S),p=!1},d(S){S&&g(e),ae(r),ae(d),C=!1,xe(H)}}}function Cl(l){let e,t,i,n,a,s,o,r,u,m,c,h;function d(w){l[28](w)}let y={};return l[12]!==void 0&&(y.value=l[12]),a=new mn({props:y}),Se.push(()=>Qe(a,"value",d)),{c(){e=V("div"),t=V("span"),i=ce("Radius"),n=Z(),ne(a.$$.fragment),o=Z(),r=V("input"),u=ce("km"),this.h()},l(w){e=N(w,"DIV",{class:!0});var p=M(e);t=N(p,"SPAN",{});var C=M(t);i=de(C,"Radius"),C.forEach(g),n=Y(p),be(a.$$.fragment,p),o=Y(p),r=N(p,"INPUT",{type:!0}),u=de(p,"km"),p.forEach(g),this.h()},h(){b(r,"type","text"),b(e,"class","slider")},m(w,p){D(w,e,p),L(e,t),L(t,i),L(e,n),se(a,e,null),L(e,o),L(e,r),ut(r,l[12]),L(e,u),m=!0,c||(h=x(r,"input",l[29]),c=!0)},p(w,p){const C={};!s&&p[0]&4096&&(s=!0,C.value=w[12],it(()=>s=!1)),a.$set(C),p[0]&4096&&r.value!==w[12]&&ut(r,w[12])},i(w){m||(B(a.$$.fragment,w),m=!0)},o(w){z(a.$$.fragment,w),m=!1},d(w){w&&g(e),ae(a),c=!1,h()}}}function In(l){let e,t,i,n;return{c(){e=V("strong"),t=ce("Pan and zoom mode"),i=V("br"),n=ce(`
      Explore the map to find a location of interest, then select a drawing tool
      from the menu.`)},l(a){e=N(a,"STRONG",{});var s=M(e);t=de(s,"Pan and zoom mode"),s.forEach(g),i=N(a,"BR",{}),n=de(a,`
      Explore the map to find a location of interest, then select a drawing tool
      from the menu.`)},m(a,s){D(a,e,s),L(e,t),D(a,i,s),D(a,n,s)},p:me,d(a){a&&g(e),a&&g(i),a&&g(n)}}}function Ln(l){let e,t,i,n;return{c(){e=V("strong"),t=ce("Click and select mode"),i=V("br"),n=ce(`
      Click an individual area to add or remove it from your selection.`)},l(a){e=N(a,"STRONG",{});var s=M(e);t=de(s,"Click and select mode"),s.forEach(g),i=N(a,"BR",{}),n=de(a,`
      Click an individual area to add or remove it from your selection.`)},m(a,s){D(a,e,s),L(e,t),D(a,i,s),D(a,n,s)},p:me,d(a){a&&g(e),a&&g(i),a&&g(n)}}}function En(l){let e,t,i,n;return{c(){e=V("strong"),t=ce("Draw a radius mode"),i=V("br"),n=ce(`
      Select a radius in kilometres from the menu, then click on the map to draw
      a circle.`)},l(a){e=N(a,"STRONG",{});var s=M(e);t=de(s,"Draw a radius mode"),s.forEach(g),i=N(a,"BR",{}),n=de(a,`
      Select a radius in kilometres from the menu, then click on the map to draw
      a circle.`)},m(a,s){D(a,e,s),L(e,t),D(a,i,s),D(a,n,s)},p:me,d(a){a&&g(e),a&&g(i),a&&g(n)}}}function Cn(l){let e,t,i,n;return{c(){e=V("strong"),t=ce("Draw a polygon mode"),i=V("br"),n=ce(`
      Click on the map to draw a polygon. Click again on the first or last point
      to close the polygon.`)},l(a){e=N(a,"STRONG",{});var s=M(e);t=de(s,"Draw a polygon mode"),s.forEach(g),i=N(a,"BR",{}),n=de(a,`
      Click on the map to draw a polygon. Click again on the first or last point
      to close the polygon.`)},m(a,s){D(a,e,s),L(e,t),D(a,i,s),D(a,n,s)},p:me,d(a){a&&g(e),a&&g(i),a&&g(n)}}}function On(l){let e,t,i,n;return{c(){e=V("strong"),t=ce("How to get started"),i=V("br"),n=ce(`
      Zoom in to an area on the map to start drawing, or use the search box above
      to find a ready-made area.`)},l(a){e=N(a,"STRONG",{});var s=M(e);t=de(s,"How to get started"),s.forEach(g),i=N(a,"BR",{}),n=de(a,`
      Zoom in to an area on the map to start drawing, or use the search box above
      to find a ready-made area.`)},m(a,s){D(a,e,s),L(e,t),D(a,i,s),D(a,n,s)},p:me,d(a){a&&g(e),a&&g(i),a&&g(n)}}}function Tn(l){let e,t,i,n,a,s,o,r,u;return{c(){e=V("strong"),t=ce("Zoom in to continue"),i=V("br"),n=ce(`
      You can
      `),a=V("button"),s=ce("click here"),o=ce(" to return to the area you have drawn."),this.h()},l(m){e=N(m,"STRONG",{});var c=M(e);t=de(c,"Zoom in to continue"),c.forEach(g),i=N(m,"BR",{}),n=de(m,`
      You can
      `),a=N(m,"BUTTON",{class:!0});var h=M(a);s=de(h,"click here"),h.forEach(g),o=de(m," to return to the area you have drawn."),this.h()},h(){b(a,"class","btn-link")},m(m,c){D(m,e,c),L(e,t),D(m,i,c),D(m,n,c),D(m,a,c),L(a,s),D(m,o,c),r||(u=x(a,"click",l[37]),r=!0)},p:me,d(m){m&&g(e),m&&g(i),m&&g(n),m&&g(a),m&&g(o),r=!1,u()}}}function Vn(l){let e,t,i,n,a,s,o,r,u,m,c,h,d,y,w,p,C,H,S,_,T,X,te,j,P,A,U,G,K,J,k,O,re,ke,we,Ie,Fe,_e,Me,ge,Ce,Ee,Ve,I,R,F,he,ee=l[4].toLocaleString()+"",q,$=`${l[6]||l[1].showSave?200:158}px`,ie,Ye,De,je=l[7],v=[];for(let E=0;E<je.length;E+=1)v[E]=El(Ll(l,je,E));const Le=E=>z(v[E],1,1,()=>{v[E]=null}),$e=[wn,yn],qe=[];function gt(E,Q){return E[0]?0:1}r=gt(l),u=qe[r]=$e[r](l),h=new Xe({props:{type:"clear"}}),w=new Xe({props:{type:l[1].showSave?"add":"download",rotation:l[1].showSave?45:0}}),X=new Xe({props:{type:"chevron"}});const pt=[kn,Sn],Ge=[];function yt(E,Q){return E[1].showSave?0:E[6]?1:-1}~(P=yt(l))&&(A=Ge[P]=pt[P](l)),K=new bn({props:{drawing_tools:!0}}),re=new cn({}),re.$on("select",l[34]),Ie=new Xe({props:{type:"upload"}});function wt(E,Q){return(!E[2]||E[2]<kt)&&E[8][E[8].length-1].oa.size>0?Tn:!E[2]||E[2]<9?On:E[1].mode=="polygon"?Cn:E[1].mode=="radius"?En:E[1].mode=="select"?Ln:In}let ct=wt(l),Ne=ct(l);return{c(){e=V("script"),i=Z(),n=V("nav"),a=V("div");for(let E=0;E<v.length;E+=1)v[E].c();s=Z(),o=V("div"),u.c(),m=Z(),c=V("button"),ne(h.$$.fragment),d=Z(),y=V("button"),ne(w.$$.fragment),H=Z(),S=V("button"),_=V("span"),T=ce("Build profile"),ne(X.$$.fragment),j=Z(),A&&A.c(),U=Z(),G=V("div"),ne(K.$$.fragment),J=Z(),k=V("aside"),O=V("div"),ne(re.$$.fragment),ke=Z(),we=V("button"),ne(Ie.$$.fragment),Fe=Z(),_e=V("input"),Me=Z(),ge=V("div"),Ne.c(),Ce=Z(),Ee=V("br"),Ve=Z(),I=V("p"),R=V("span"),F=ce("Population selected:"),he=Z(),q=ce(ee),this.h()},l(E){const Q=oi("svelte-12u6pls",Il.head);e=N(Q,"SCRIPT",{src:!0});var Be=M(e);Be.forEach(g),Q.forEach(g),i=Y(E),n=N(E,"NAV",{});var le=M(n);a=N(le,"DIV",{class:!0,style:!0});var He=M(a);for(let St=0;St<v.length;St+=1)v[St].l(He);He.forEach(g),s=Y(le),o=N(le,"DIV",{class:!0});var oe=M(o);u.l(oe),m=Y(oe),c=N(oe,"BUTTON",{class:!0,title:!0});var et=M(c);be(h.$$.fragment,et),et.forEach(g),d=Y(oe),y=N(oe,"BUTTON",{title:!0});var bt=M(y);be(w.$$.fragment,bt),bt.forEach(g),H=Y(oe),S=N(oe,"BUTTON",{class:!0});var nt=M(S);_=N(nt,"SPAN",{});var Et=M(_);T=de(Et,"Build profile"),Et.forEach(g),be(X.$$.fragment,nt),nt.forEach(g),oe.forEach(g),le.forEach(g),j=Y(E),A&&A.l(E),U=Y(E),G=N(E,"DIV",{id:!0});var Ct=M(G);be(K.$$.fragment,Ct),Ct.forEach(g),J=Y(E),k=N(E,"ASIDE",{class:!0});var Je=M(k);O=N(Je,"DIV",{class:!0});var st=M(O);be(re.$$.fragment,st),ke=Y(st),we=N(st,"BUTTON",{title:!0});var Ot=M(we);be(Ie.$$.fragment,Ot),Ot.forEach(g),Fe=Y(st),_e=N(st,"INPUT",{type:!0,accept:!0,style:!0}),st.forEach(g),Me=Y(Je),ge=N(Je,"DIV",{class:!0});var at=M(ge);Ne.l(at),Ce=Y(at),Ee=N(at,"BR",{}),Ve=Y(at),I=N(at,"P",{});var vt=M(I);R=N(vt,"SPAN",{style:!0});var Tt=M(R);F=de(Tt,"Population selected:"),Tt.forEach(g),he=Y(vt),q=de(vt,ee),vt.forEach(g),at.forEach(g),Je.forEach(g),this.h()},h(){ui(e.src,t="https://cdn.jsdelivr.net/npm/flatbush")||b(e,"src",t),b(a,"class","nav-left"),Oe(a,"z-index","99"),b(c,"class","alert"),b(c,"title","Clear all areas"),b(y,"title",p=l[1].showSave?"Close save options":"Save selected area"),y.disabled=C=!l[8][l[8].length-1].oa.size>0,fe(y,"active",l[1].showSave),b(S,"class","text confirm"),S.disabled=te=!l[8][l[8].length-1].oa.size>0,b(o,"class","nav-right"),b(G,"id","map"),b(we,"title","Upload a saved area"),b(_e,"type","file"),b(_e,"accept",".geojson,.json"),Oe(_e,"display","none"),b(O,"class","search"),Oe(R,"font-weight","bold"),b(ge,"class","message"),b(k,"class","info-box"),Oe(k,"top",$)},m(E,Q){L(Il.head,e),D(E,i,Q),D(E,n,Q),L(n,a);for(let Be=0;Be<v.length;Be+=1)v[Be].m(a,null);L(n,s),L(n,o),qe[r].m(o,null),L(o,m),L(o,c),se(h,c,null),L(o,d),L(o,y),se(w,y,null),L(o,H),L(o,S),L(S,_),L(_,T),se(X,S,null),D(E,j,Q),~P&&Ge[P].m(E,Q),D(E,U,Q),D(E,G,Q),se(K,G,null),D(E,J,Q),D(E,k,Q),L(k,O),se(re,O,null),L(O,ke),L(O,we),se(Ie,we,null),L(O,Fe),L(O,_e),l[36](_e),L(k,Me),L(k,ge),Ne.m(ge,null),L(ge,Ce),L(ge,Ee),L(ge,Ve),L(ge,I),L(I,R),L(R,F),L(I,he),L(I,q),ie=!0,Ye||(De=[ht(mt.call(null,c)),x(c,"click",l[22]),ht(mt.call(null,y)),x(y,"click",l[23]),x(S,"click",l[24]),ht(mt.call(null,we)),x(we,"click",l[35]),x(_e,"change",l[15])],Ye=!0)},p(E,Q){if(Q[0]&2182){je=E[7];let oe;for(oe=0;oe<je.length;oe+=1){const et=Ll(E,je,oe);v[oe]?(v[oe].p(et,Q),B(v[oe],1)):(v[oe]=El(et),v[oe].c(),B(v[oe],1),v[oe].m(a,null))}for(ve(),oe=je.length;oe<v.length;oe+=1)Le(oe);pe()}let Be=r;r=gt(E),r===Be?qe[r].p(E,Q):(ve(),z(qe[Be],1,1,()=>{qe[Be]=null}),pe(),u=qe[r],u?u.p(E,Q):(u=qe[r]=$e[r](E),u.c()),B(u,1),u.m(o,m));const le={};Q[0]&2&&(le.type=E[1].showSave?"add":"download"),Q[0]&2&&(le.rotation=E[1].showSave?45:0),w.$set(le),(!ie||Q[0]&2&&p!==(p=E[1].showSave?"Close save options":"Save selected area"))&&b(y,"title",p),(!ie||Q[0]&256&&C!==(C=!E[8][E[8].length-1].oa.size>0))&&(y.disabled=C),(!ie||Q[0]&2)&&fe(y,"active",E[1].showSave),(!ie||Q[0]&256&&te!==(te=!E[8][E[8].length-1].oa.size>0))&&(S.disabled=te);let He=P;P=yt(E),P===He?~P&&Ge[P].p(E,Q):(A&&(ve(),z(Ge[He],1,1,()=>{Ge[He]=null}),pe()),~P?(A=Ge[P],A?A.p(E,Q):(A=Ge[P]=pt[P](E),A.c()),B(A,1),A.m(U.parentNode,U)):A=null),ct===(ct=wt(E))&&Ne?Ne.p(E,Q):(Ne.d(1),Ne=ct(E),Ne&&(Ne.c(),Ne.m(ge,Ce))),(!ie||Q[0]&16)&&ee!==(ee=E[4].toLocaleString()+"")&&It(q,ee),Q[0]&66&&$!==($=`${E[6]||E[1].showSave?200:158}px`)&&Oe(k,"top",$)},i(E){if(!ie){for(let Q=0;Q<je.length;Q+=1)B(v[Q]);B(u),B(h.$$.fragment,E),B(w.$$.fragment,E),B(X.$$.fragment,E),B(A),B(K.$$.fragment,E),B(re.$$.fragment,E),B(Ie.$$.fragment,E),ie=!0}},o(E){v=v.filter(Boolean);for(let Q=0;Q<v.length;Q+=1)z(v[Q]);z(u),z(h.$$.fragment,E),z(w.$$.fragment,E),z(X.$$.fragment,E),z(A),z(K.$$.fragment,E),z(re.$$.fragment,E),z(Ie.$$.fragment,E),ie=!1},d(E){g(e),E&&g(i),E&&g(n),Bt(v,E),qe[r].d(),ae(h),ae(w),ae(X),E&&g(j),~P&&Ge[P].d(E),E&&g(U),E&&g(G),ae(K),E&&g(J),E&&g(k),ae(re),ae(Ie),l[36](null),Ne.d(),Ye=!1,xe(De)}}}const kt=8;function Nn(l,e,t){let i,n,a,s,o,r,u,m,c,h,d;ze(l,Pe,F=>t(8,a=F)),ze(l,Kt,F=>t(9,s=F)),ze(l,Ze,F=>t(10,o=F)),ze(l,Nt,F=>t(38,r=F)),ze(l,At,F=>t(39,u=F)),ze(l,Ft,F=>t(40,m=F)),ze(l,$t,F=>t(11,c=F)),ze(l,Rt,F=>t(12,h=F)),ze(l,Wt,F=>t(13,d=F));const y=[{key:"move",label:"Pan and zoom"},{key:"select",label:"Click to select"},{key:"polygon",label:"Draw a polygon"},{key:"radius",label:"Draw a radius"}];let w=!0,p={mode:"move",radius:5,select:"add",name:"Area Name",showSave:!1,topics:[],topicsExpand:!1,topicsFilter:""},C,H,S="0";function _(){let F=a[a.length-1];F=JSON.stringify(F,(he,ee)=>ee instanceof Set?[...ee]:ee),localStorage.setItem("draw_data",F)}let T;async function X(){document.body.style.opacity=.1,new Date(localStorage.getItem("lastdate"))<new Date("18/18/2022")&&localStorage.clear(),localStorage.setItem("lastdate",+new Date);var F=await pn({year:21,dfd});Ze.set(F),Ae(Ft,m={area:{type:"vector",maxzoom:Nl,minzoom:Vl,tiles:[`${pi}/{z}/{x}/{y}.pbf`]}},m),Ae(At,u=[{id:"bounds",source:"area","source-layer":"oa",type:"fill",paint:{"fill-color":"transparent","fill-opacity":1,"fill-outline-color":"steelblue"}}],u),"SpeechSynthesisUtterance"in window&&(new SpeechSynthesisUtterance,console.debug("speech tools enabled")),Ae(Nt,r=[{event:"contextmenu",layer:"bounds",callback:ee=>{}}],r);async function he(){const ee=a[a.length-1];t(4,S=ee.oa.size?[...ee.oa].map(q=>lt(Ze).population[q]||0).reduce((q,$)=>q+$):0),console.debug("---recolour",ee),s.setPaintProperty("bounds","fill-color",["match",["get","areacd"],["literal",...ee.oa],"rgba(32, 96, 149, 0.4)","transparent"])}s.on("load",async()=>{Pe.subscribe(he),t(5,T=function(){localStorage.clear(),Pe.set([{oa:new Set,parents:[]}])});let ee=window.location.hash;if(ee==="#undefined")ee=window.location.hash="";else if(ee.length==10){let ie=[ee.slice(1)];if(T(),+await lt(Ze).indf(ie)>-1){try{$=lt(Ze).bounds(ie),Ae(Pe,a=[a,{oa:new Set(ie),parents:lt(Ze).parent(ie)}],a),s.fitBounds($,{padding:20}),t(1,p.name=ie,p)}catch{ie=ie[0];let De=await _i("ONSvisual","cp-places-data",`${ie.slice(0,3)}/${ie}.json`);Pe.set([{oa:new Set,parents:[]}]),localStorage.clear(),De.type=="Feature"&&(Ae(Pe,a=[a,{oa:new Set(De.properties.codes),parents:lt(Ze).parent(De.properties.codes)}],a),s.fitBounds(De.properties.bounds,{padding:20}),t(1,p.name=De.properties.areanm,p))}_()}history.replaceState(null,null," ")}else if(localStorage.getItem("onsbuild")){var q=JSON.parse(localStorage.getItem("onsbuild")).properties;if(t(1,p.name=q.name,p),!q.oa_all.length)return T(),0;var $=lt(Ze).bounds([...q.oa_all]);s.fitBounds($,{padding:20,linear:!0}),Ae(Pe,a=[{oa:q.oa_all,parents:lt(Ze).parent(q.oa_all)}],a)}else if(localStorage.getItem("draw_data")){var q=JSON.parse(localStorage.getItem("draw_data"));if(!q.oa.length)return T(),0;var $=lt(Ze).bounds([...q.oa]);s.fitBounds($,{padding:20,linear:!0}),q.oa=new Set(q.oa),Pe.set([q])}t(2,C=s.getZoom()),s.on("moveend",()=>t(2,C=s.getZoom()))})}function te(){let F=H.files[0]?H.files[0]:null;if(F){Pe.set([{oa:new Set,parents:[]}]);const he=new FileReader;he.onload=ee=>{let q=JSON.parse(ee.target.result);if(q.type=="FeatureCollection"?q=q.features[0]:q.type=="Geometry"&&(q={type:"Feature",geometry:q}),q.properties&&q.properties.codes){console.debug("reading uploaded codes");let $=q.properties.bbox?q.properties.bbox:o.getbbox(boundary),ie=new Set(q.properties.codes);Ae(Pe,a=[a,{oa:ie,parents:lt(Ze).parent(ie)}],a),s.fitBounds($,{padding:20})}else if(q.geometry){console.debug("reading uploaded geometry"),JSON.stringify(q.geometry).length>1e4&&(q.geometry=yi(q.geometry,1e4));let $=bbox(q),ie=[($[0]+$[2])/2,($[1]+$[3])/2];s.flyTo({center:ie,zoom:9}),s.once("idle",()=>{wi(q.geometry),s.fitBounds($,{padding:20})})}else q=null,alert("Invalid geography file. Must be geojson format.");if(q){let $=q.properties;t(1,p.name=$&&$.areanm?$.areanm:$&&$.name?$.name:"Area Name",p),_()}},he.readAsText(F)}}ft(async()=>{await X(),setTimeout(()=>{document.body.style.opacity=1},2e3)});async function j(){return document.querySelector("#mapcontainer div canvas").style.cursor="wait",o.simplify(p.name,a[a.length-1],s).then(F=>F&&a[a.length-1].oa.size>0?F.error?!1:(console.debug("buildpage",F),localStorage.setItem("onsbuild",JSON.stringify(F)),document.querySelector("#mapcontainer div canvas").style.cursor="auto",!0):(alert("No features selected."),document.querySelector("#mapcontainer div canvas").style.cursor="auto",!1))}const P=[[],[]];function A(){p.mode=this.__value,t(1,p)}const U=function(F){Ae($t,c=F.key=="move"?null:F.key,c)},G=()=>{Ae(Pe,a=a.slice(0,-1),a),_()},K=()=>{t(0,w=!0)},J=()=>{T(),t(1,p.name="Area Name",p)},k=()=>t(1,p.showSave=!p.showSave,p),O=()=>j().then(F=>{console.warn(F),F?gi(`${Si}/build/`):console.error("not redirecting",F)});function re(){p.name=this.value,t(1,p)}const ke=()=>j().then(()=>{var F=JSON.parse(localStorage.getItem("onsbuild")),he=new Blob([JSON.stringify(F.geojson)],{type:"text/plain"});bi(he,p.name.replace(" ","_")+".geojson")}),we=()=>vi(Array.from(a[a.length-1].oa).join(","),"Copied output area codes to clipboard");function Ie(F){h=F,Rt.set(h)}function Fe(){h=this.value,Rt.set(h)}const _e=()=>Ae(Wt,d=!0,d);function Me(){p.select=this.__value,t(1,p)}function ge(){p.select=this.__value,t(1,p)}const Ce=()=>Ae(Wt,d=!1,d),Ee=F=>{if(T(),F.detail.type=="place"){let he=F.detail.bbox,ee=new Set(F.detail.codes);Ae(Pe,a=[a,{oa:ee,parents:o.parent([...ee])}],a),s.fitBounds(he,{padding:20}),t(1,p.name=F.detail.areanm,p)}else if(F.detail.type=="postcode"){let he=F.detail.center;s.flyTo({center:he,zoom:14}),s.once("idle",()=>{let ee=s.project(he),q=s.queryRenderedFeatures([ee.x,ee.y],{layers:["bounds"]});var $=new Set(q.map(ie=>ie.properties.oa));Ae(Pe,a=[a,{oa:$,parents:o.parent([...$])}],a)})}_()},Ve=()=>H.click();function I(F){Se[F?"unshift":"push"](()=>{H=F,t(3,H)})}const R=()=>{let F=a[a.length-1],he=[F.lng[0],F.lat[0],F.lng[1],F.lat[1]];s.fitBounds(he,{padding:20})};return l.$$.update=()=>{l.$$.dirty[0]&1&&t(7,i=w?y:y.slice(0,2)),l.$$.dirty[0]&2&&t(6,n=["polygon","radius"].includes(p.mode))},[w,p,C,H,S,T,n,i,a,s,o,c,h,d,_,te,j,A,P,U,G,K,J,k,O,re,ke,we,Ie,Fe,_e,Me,ge,Ce,Ee,Ve,I,R]}class Bn extends We{constructor(e){super(),Ue(this,e,Nn,Vn,Ke,{},null,[-1,-1])}}export{Bn as default};
